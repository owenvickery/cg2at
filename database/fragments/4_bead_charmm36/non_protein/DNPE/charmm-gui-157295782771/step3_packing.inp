* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v2.0 on Nov, 05. 2019. JOBID=157295782771
* GENERATES LIPID PACKING USING BIG SPHERES
* 

DIMENS CHSIZE 3000000 MAXRES 3000000

! Read topology and parameter files
stream toppar.str

define PROT sele none end
set nprot = 0

! Read the system information
stream step3_size.str
stream step3_nlipids_upper.prm
stream step3_nlipids_lower.prm

! Read toppar for big-spheres (POL) 
stream step3_packing_pol.str

! Generate big-spheres (POL) for upper leaflet
read sequence POL @NLIPTOP
generate UPPO warn

! Generate big-spheres (POL) for lower leaflet
read sequence POL @NLIPBOT
generate DNPO warn

!
! find chemical types of POLF
!

read sequence POLF 1
generate POLF warn

scalar type stat sele segid POLF end
calc ipolf = int ( ?save )

delete atom sele segid POLF end

!
! find chemical types of POL2
!

read sequence POL2 1
generate POL2 warn

scalar type stat sele segid POL2 end
calc ipol2 = int ( ?save )

delete atom sele segid POL2 end

!
! Change resnames [upper leaflet]
!

calc cnt1 = 0
calc cnt2 = 0

if nchl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchl1top} - 1
   rename resname CHL1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nergtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nergtop} - 1
   rename resname ERG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsitotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsitotop} - 1
   rename resname SITO select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nstigtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nstigtop} - 1
   rename resname STIG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nchsdtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchsdtop} - 1
   rename resname CHSD select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nchsptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchsptop} - 1
   rename resname CHSP select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpatop} - 1
   rename resname DLPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpatop} - 1
   rename resname DMPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppatop} - 1
   rename resname DPPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndspatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspatop} - 1
   rename resname DSPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopatop} - 1
   rename resname POPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpatop} - 1
   rename resname PLPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsopatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopatop} - 1
   rename resname SOPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nslpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpatop} - 1
   rename resname SLPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypatop} - 1
   rename resname DYPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nyopatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopatop} - 1
   rename resname YOPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopatop} - 1
   rename resname DOPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpatop} - 1
   rename resname DGPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndepatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepatop} - 1
   rename resname DEPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpatop} - 1
   rename resname DNPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndtpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndtpatop} - 1
   rename resname DTPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntipatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntipatop} - 1
   rename resname TIPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndipatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndipatop} - 1
   rename resname DIPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nllpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpatop} - 1
   rename resname LLPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddpctop} - 1
   rename resname DDPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndcpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndcpctop} - 1
   rename resname DCPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpctop} - 1
   rename resname DLPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpctop} - 1
   rename resname DMPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppctop} - 1
   rename resname DPPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndspctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspctop} - 1
   rename resname DSPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopctop} - 1
   rename resname POPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpctop} - 1
   rename resname PLPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npdopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npdopctop} - 1
   rename resname PDOPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopctop} - 1
   rename resname SOPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nslpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpctop} - 1
   rename resname SLPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndrpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndrpctop} - 1
   rename resname DRPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypctop} - 1
   rename resname DYPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nyopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopctop} - 1
   rename resname YOPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopctop} - 1
   rename resname DOPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndupctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndupctop} - 1
   rename resname DUPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpctop} - 1
   rename resname DGPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndepctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepctop} - 1
   rename resname DEPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddopctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddopctop} - 1
   rename resname DDOPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpctop} - 1
   rename resname DNPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlipctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlipctop} - 1
   rename resname DLIPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nllpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpctop} - 1
   rename resname LLPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpetop} - 1
   rename resname DLPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpetop} - 1
   rename resname DMPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppetop} - 1
   rename resname DPPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndspetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspetop} - 1
   rename resname DSPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npypetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npypetop} - 1
   rename resname PYPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopetop} - 1
   rename resname POPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpetop} - 1
   rename resname PLPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npdopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npdopetop} - 1
   rename resname PDOPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopetop} - 1
   rename resname SOPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nslpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpetop} - 1
   rename resname SLPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypetop} - 1
   rename resname DYPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nyopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopetop} - 1
   rename resname YOPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if noypetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{noypetop} - 1
   rename resname OYPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopetop} - 1
   rename resname DOPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpetop} - 1
   rename resname DGPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndepetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepetop} - 1
   rename resname DEPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddopetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddopetop} - 1
   rename resname DDOPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpetop} - 1
   rename resname DNPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlipetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlipetop} - 1
   rename resname DLIPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nllpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpetop} - 1
   rename resname LLPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpgtop} - 1
   rename resname DLPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpgtop} - 1
   rename resname DMPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppgtop} - 1
   rename resname DPPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndspgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspgtop} - 1
   rename resname DSPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npypgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npypgtop} - 1
   rename resname PYPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopgtop} - 1
   rename resname POPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpgtop} - 1
   rename resname PLPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsopgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopgtop} - 1
   rename resname SOPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nslpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpgtop} - 1
   rename resname SLPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypgtop} - 1
   rename resname DYPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopgtop} - 1
   rename resname DOPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpgtop} - 1
   rename resname DGPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndepgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepgtop} - 1
   rename resname DEPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpgtop} - 1
   rename resname DNPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpstop} - 1
   rename resname DLPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpstop} - 1
   rename resname DMPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppstop} - 1
   rename resname DPPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndspstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspstop} - 1
   rename resname DSPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopstop} - 1
   rename resname POPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpstop} - 1
   rename resname PLPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsopstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopstop} - 1
   rename resname SOPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nslpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpstop} - 1
   rename resname SLPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndypstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypstop} - 1
   rename resname DYPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nyopstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopstop} - 1
   rename resname YOPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopstop} - 1
   rename resname DOPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndgpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpstop} - 1
   rename resname DGPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndepstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepstop} - 1
   rename resname DEPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddopstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddopstop} - 1
   rename resname DDOPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndnpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpstop} - 1
   rename resname DNPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nllpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpstop} - 1
   rename resname LLPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopp1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopp1top} - 1
   rename resname POPP1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopp2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopp2top} - 1
   rename resname POPP2 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopp3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopp3top} - 1
   rename resname POPP3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopp1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopp1top} - 1
   rename resname DOPP1 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopp2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopp2top} - 1
   rename resname DOPP2 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopp3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopp3top} - 1
   rename resname DOPP3 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpitop} - 1
   rename resname DMPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi13top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi13top} - 1
   rename resname DMPI13 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi14top} - 1
   rename resname DMPI14 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi15top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi15top} - 1
   rename resname DMPI15 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi24top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi24top} - 1
   rename resname DMPI24 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi25top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi25top} - 1
   rename resname DMPI25 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2atop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2atop} - 1
   rename resname DMPI2A select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2btop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2btop} - 1
   rename resname DMPI2B select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2ctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2ctop} - 1
   rename resname DMPI2C select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2dtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2dtop} - 1
   rename resname DMPI2D select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi33top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi33top} - 1
   rename resname DMPI33 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi34top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi34top} - 1
   rename resname DMPI34 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi35top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi35top} - 1
   rename resname DMPI35 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npypitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npypitop} - 1
   rename resname PYPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopitop} - 1
   rename resname POPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi13top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi13top} - 1
   rename resname POPI13 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi14top} - 1
   rename resname POPI14 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi15top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi15top} - 1
   rename resname POPI15 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi24top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi24top} - 1
   rename resname POPI24 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi25top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi25top} - 1
   rename resname POPI25 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi2atop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2atop} - 1
   rename resname POPI2A select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi2btop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2btop} - 1
   rename resname POPI2B select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi2ctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2ctop} - 1
   rename resname POPI2C select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi2dtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2dtop} - 1
   rename resname POPI2D select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi33top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi33top} - 1
   rename resname POPI33 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi34top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi34top} - 1
   rename resname POPI34 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopi35top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi35top} - 1
   rename resname POPI35 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpitop} - 1
   rename resname PLPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi13top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi13top} - 1
   rename resname PLPI13 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi14top} - 1
   rename resname PLPI14 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi15top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi15top} - 1
   rename resname PLPI15 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi24top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi24top} - 1
   rename resname PLPI24 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi25top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi25top} - 1
   rename resname PLPI25 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2atop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2atop} - 1
   rename resname PLPI2A select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2btop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2btop} - 1
   rename resname PLPI2B select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2ctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2ctop} - 1
   rename resname PLPI2C select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2dtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2dtop} - 1
   rename resname PLPI2D select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi33top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi33top} - 1
   rename resname PLPI33 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi34top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi34top} - 1
   rename resname PLPI34 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nplpi35top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi35top} - 1
   rename resname PLPI35 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpitop} - 1
   rename resname PNPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi13top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi13top} - 1
   rename resname PNPI13 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi14top} - 1
   rename resname PNPI14 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi15top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi15top} - 1
   rename resname PNPI15 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi24top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi24top} - 1
   rename resname PNPI24 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi25top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi25top} - 1
   rename resname PNPI25 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2atop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2atop} - 1
   rename resname PNPI2A select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2btop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2btop} - 1
   rename resname PNPI2B select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2ctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2ctop} - 1
   rename resname PNPI2C select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2dtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2dtop} - 1
   rename resname PNPI2D select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi33top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi33top} - 1
   rename resname PNPI33 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi34top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi34top} - 1
   rename resname PNPI34 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npnpi35top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi35top} - 1
   rename resname PNPI35 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapitop} - 1
   rename resname SAPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi13top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi13top} - 1
   rename resname SAPI13 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi14top} - 1
   rename resname SAPI14 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi15top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi15top} - 1
   rename resname SAPI15 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi24top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi24top} - 1
   rename resname SAPI24 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi25top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi25top} - 1
   rename resname SAPI25 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2atop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2atop} - 1
   rename resname SAPI2A select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2btop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2btop} - 1
   rename resname SAPI2B select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2ctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2ctop} - 1
   rename resname SAPI2C select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2dtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2dtop} - 1
   rename resname SAPI2D select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi33top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi33top} - 1
   rename resname SAPI33 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi34top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi34top} - 1
   rename resname SAPI34 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapi35top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi35top} - 1
   rename resname SAPI35 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndlipitop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlipitop} - 1
   rename resname DLIPI select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntmcl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntmcl1top} - 1
   rename resname TMCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntmcl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntmcl2top} - 1
   rename resname TMCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npmcl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmcl1top} - 1
   rename resname PMCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npmcl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmcl2top} - 1
   rename resname PMCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvcl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npvcl2top} - 1
   rename resname PVCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntycl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntycl1top} - 1
   rename resname TYCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntycl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntycl2top} - 1
   rename resname TYCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntocl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntocl1top} - 1
   rename resname TOCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntocl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntocl2top} - 1
   rename resname TOCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nloacl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloacl1top} - 1
   rename resname LOACL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nloacl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloacl2top} - 1
   rename resname LOACL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nloccl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloccl1top} - 1
   rename resname LOCCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nloccl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloccl2top} - 1
   rename resname LOCCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntlcl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntlcl1top} - 1
   rename resname TLCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntlcl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntlcl2top} - 1
   rename resname TLCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlnccl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnccl1top} - 1
   rename resname LNCCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlnccl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnccl2top} - 1
   rename resname LNCCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlnacl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnacl1top} - 1
   rename resname LNACL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlnacl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnacl2top} - 1
   rename resname LNACL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlndcl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlndcl1top} - 1
   rename resname LNDCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlndcl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlndcl2top} - 1
   rename resname LNDCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlnbcl1top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnbcl1top} - 1
   rename resname LNBCL1 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlnbcl2top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnbcl2top} - 1
   rename resname LNBCL2 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapatop} - 1
   rename resname SAPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapctop} - 1
   rename resname SAPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapetop} - 1
   rename resname SAPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapgtop} - 1
   rename resname SAPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsapstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapstop} - 1
   rename resname SAPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpatop} - 1
   rename resname SDPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpctop} - 1
   rename resname SDPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpetop} - 1
   rename resname SDPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpgtop} - 1
   rename resname SDPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdpstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpstop} - 1
   rename resname SDPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapatop} - 1
   rename resname DAPA select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapctop} - 1
   rename resname DAPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapetop} - 1
   rename resname DAPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapgtop} - 1
   rename resname DAPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndapstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapstop} - 1
   rename resname DAPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntspctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntspctop} - 1
   rename resname TSPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npsmtop} - 1
   rename resname PSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nssmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nssmtop} - 1
   rename resname SSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nasmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nasmtop} - 1
   rename resname ASM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbsmtop} - 1
   rename resname BSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if n23smtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{n23smtop} - 1
   rename resname 23SM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlsmtop} - 1
   rename resname LSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nosmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nosmtop} - 1
   rename resname OSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nnsmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnsmtop} - 1
   rename resname NSM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer160top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer160top} - 1
   rename resname CER160 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer180top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer180top} - 1
   rename resname CER180 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer181top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer181top} - 1
   rename resname CER181 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer200top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer200top} - 1
   rename resname CER200 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer220top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer220top} - 1
   rename resname CER220 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer240top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer240top} - 1
   rename resname CER240 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer241top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer241top} - 1
   rename resname CER241 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncer3etop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer3etop} - 1
   rename resname CER3E select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nqmpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nqmpetop} - 1
   rename resname QMPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npmpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmpetop} - 1
   rename resname PMPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npmpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmpgtop} - 1
   rename resname PMPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npppetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npppetop} - 1
   rename resname PPPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvpetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npvpetop} - 1
   rename resname PVPE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npvpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npvpgtop} - 1
   rename resname PVPG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nappctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nappctop} - 1
   rename resname APPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nippctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nippctop} - 1
   rename resname IPPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nphpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nphpctop} - 1
   rename resname PHPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppgktop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppgktop} - 1
   rename resname DPPGK select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlautop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlautop} - 1
   rename resname LAU select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nmyrtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyrtop} - 1
   rename resname MYR select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npaltop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npaltop} - 1
   rename resname PAL select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nstetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nstetop} - 1
   rename resname STE select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naratop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naratop} - 1
   rename resname ARA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbehtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbehtop} - 1
   rename resname BEH select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntritop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntritop} - 1
   rename resname TRI select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nligntop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nligntop} - 1
   rename resname LIGN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nmyrotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyrotop} - 1
   rename resname MYRO select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npalotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npalotop} - 1
   rename resname PALO select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhtatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhtatop} - 1
   rename resname HTA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if noletop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{noletop} - 1
   rename resname OLE select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlintop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlintop} - 1
   rename resname LIN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nalintop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nalintop} - 1
   rename resname ALIN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdatop} - 1
   rename resname SDA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nglatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nglatop} - 1
   rename resname GLA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if neicotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{neicotop} - 1
   rename resname EICO select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nedatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nedatop} - 1
   rename resname EDA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nmeatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmeatop} - 1
   rename resname MEA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndglatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndglatop} - 1
   rename resname DGLA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if netetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{netetop} - 1
   rename resname ETE select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if netatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{netatop} - 1
   rename resname ETA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nepatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nepatop} - 1
   rename resname EPA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if narantop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{narantop} - 1
   rename resname ARAN select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhpatop} - 1
   rename resname HPA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nerutop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nerutop} - 1
   rename resname ERU select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddatop} - 1
   rename resname DDA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nadrtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadrtop} - 1
   rename resname ADR select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpttop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndpttop} - 1
   rename resname DPT select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndpatop} - 1
   rename resname DPA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndhatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhatop} - 1
   rename resname DHA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nnertop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnertop} - 1
   rename resname NER select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nttatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nttatop} - 1
   rename resname TTA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntpttop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntpttop} - 1
   rename resname TPT select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntpatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntpatop} - 1
   rename resname TPA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nthatop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nthatop} - 1
   rename resname THA select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlauptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlauptop} - 1
   rename resname LAUP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nmyrptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyrptop} - 1
   rename resname MYRP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npalptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npalptop} - 1
   rename resname PALP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsteptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsteptop} - 1
   rename resname STEP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naraptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naraptop} - 1
   rename resname ARAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbehptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbehptop} - 1
   rename resname BEHP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntriptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntriptop} - 1
   rename resname TRIP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlignptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlignptop} - 1
   rename resname LIGNP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nmyroptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyroptop} - 1
   rename resname MYROP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npaloptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npaloptop} - 1
   rename resname PALOP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhtaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhtaptop} - 1
   rename resname HTAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if noleptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{noleptop} - 1
   rename resname OLEP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlinptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlinptop} - 1
   rename resname LINP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nalinptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nalinptop} - 1
   rename resname ALINP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdaptop} - 1
   rename resname SDAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nglaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nglaptop} - 1
   rename resname GLAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if neicoptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{neicoptop} - 1
   rename resname EICOP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nedaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nedaptop} - 1
   rename resname EDAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nmeaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmeaptop} - 1
   rename resname MEAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndglaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndglaptop} - 1
   rename resname DGLAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if neteptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{neteptop} - 1
   rename resname ETEP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if netaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{netaptop} - 1
   rename resname ETAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nepaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nepaptop} - 1
   rename resname EPAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naranptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naranptop} - 1
   rename resname ARANP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nhpaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhpaptop} - 1
   rename resname HPAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if neruptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{neruptop} - 1
   rename resname ERUP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddaptop} - 1
   rename resname DDAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nadrptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadrptop} - 1
   rename resname ADRP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndptptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndptptop} - 1
   rename resname DPTP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndpaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndpaptop} - 1
   rename resname DPAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndhaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhaptop} - 1
   rename resname DHAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nnerptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnerptop} - 1
   rename resname NERP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nttaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nttaptop} - 1
   rename resname TTAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntptptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntptptop} - 1
   rename resname TPTP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntpaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntpaptop} - 1
   rename resname TPAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nthaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nthaptop} - 1
   rename resname THAP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsb3-10top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsb3-10top} - 1
   rename resname SB3-10 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsb3-12top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsb3-12top} - 1
   rename resname SB3-12 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsb3-14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsb3-14top} - 1
   rename resname SB3-14 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nchapstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchapstop} - 1
   rename resname CHAPS select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nchapsotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchapsotop} - 1
   rename resname CHAPSO select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddmgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddmgtop} - 1
   rename resname DDMG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndomgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndomgtop} - 1
   rename resname DOMG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddaotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddaotop} - 1
   rename resname DDAO select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nudaotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nudaotop} - 1
   rename resname UDAO select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nldaotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nldaotop} - 1
   rename resname LDAO select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlapaotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlapaotop} - 1
   rename resname LAPAO select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntripaotop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntripaotop} - 1
   rename resname TRIPAO select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfos10top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos10top} - 1
   rename resname FOS10 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfos12top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos12top} - 1
   rename resname FOS12 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfos13top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos13top} - 1
   rename resname FOS13 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfos14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos14top} - 1
   rename resname FOS14 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfos15top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos15top} - 1
   rename resname FOS15 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfos16top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos16top} - 1
   rename resname FOS16 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nufos10top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nufos10top} - 1
   rename resname UFOS10 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlpc12top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlpc12top} - 1
   rename resname LPC12 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlpc14top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlpc14top} - 1
   rename resname LPC14 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfois9top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfois9top} - 1
   rename resname FOIS9 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nfois11top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfois11top} - 1
   rename resname FOIS11 select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc6dhpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6dhpctop} - 1
   rename resname C6DHPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc7dhpctop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc7dhpctop} - 1
   rename resname C7DHPC select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos3top} - 1
   rename resname CYFOS3 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos4top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos4top} - 1
   rename resname CYFOS4 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos5top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos5top} - 1
   rename resname CYFOS5 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos6top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos6top} - 1
   rename resname CYFOS6 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos7top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos7top} - 1
   rename resname CYFOS7 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsdstop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdstop} - 1
   rename resname SDS select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlmpgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlmpgtop} - 1
   rename resname LMPG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlppgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlppgtop} - 1
   rename resname LPPG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nddaoptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddaoptop} - 1
   rename resname DDAOP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nudaoptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nudaoptop} - 1
   rename resname UDAOP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nldaoptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nldaoptop} - 1
   rename resname LDAOP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nlapaoptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlapaoptop} - 1
   rename resname LAPAOP select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntrpaoptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntrpaoptop} - 1
   rename resname TRPAOP select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc6eg3top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6eg3top} - 1
   rename resname C6EG3 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc6eg4top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6eg4top} - 1
   rename resname C6EG4 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc6eg5top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6eg5top} - 1
   rename resname C6EG5 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc7eg4top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc7eg4top} - 1
   rename resname C7EG4 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc7eg5top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc7eg5top} - 1
   rename resname C7EG5 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc8eg4top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc8eg4top} - 1
   rename resname C8EG4 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc8eg5top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc8eg5top} - 1
   rename resname C8EG5 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc8eg6top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc8eg6top} - 1
   rename resname C8EG6 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc10eg5top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc10eg5top} - 1
   rename resname C10EG5 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc10eg6top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc10eg6top} - 1
   rename resname C10EG6 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc10eg9top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc10eg9top} - 1
   rename resname C10EG9 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc12eg7top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12eg7top} - 1
   rename resname C12EG7 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc12eg8top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12eg8top} - 1
   rename resname C12EG8 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc12eg9top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12eg9top} - 1
   rename resname C12EG9 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc12degtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12degtop} - 1
   rename resname C12DEG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc13eg8top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc13eg8top} - 1
   rename resname C13EG8 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nnidp40top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnidp40top} - 1
   rename resname NIDP40 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntx100top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntx100top} - 1
   rename resname TX100 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ntx114top .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntx114top} - 1
   rename resname TX114 select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naogtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naogtop} - 1
   rename resname AOG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbogtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbogtop} - 1
   rename resname BOG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nangtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nangtop} - 1
   rename resname ANG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbngtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbngtop} - 1
   rename resname BNG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nadgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadgtop} - 1
   rename resname ADG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbdgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdgtop} - 1
   rename resname BDG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naddgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naddgtop} - 1
   rename resname ADDG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbddgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbddgtop} - 1
   rename resname BDDG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacy3gtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy3gtop} - 1
   rename resname ACY3G select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcy3gtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy3gtop} - 1
   rename resname BCY3G select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if namhcgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{namhcgtop} - 1
   rename resname AMHCG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbmhcgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbmhcgtop} - 1
   rename resname BMHCG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naomtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naomtop} - 1
   rename resname AOM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbomtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbomtop} - 1
   rename resname BOM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nanmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nanmtop} - 1
   rename resname ANM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbnmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbnmtop} - 1
   rename resname BNM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nadmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadmtop} - 1
   rename resname ADM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbdmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdmtop} - 1
   rename resname BDM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naudmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naudmtop} - 1
   rename resname AUDM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbudmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbudmtop} - 1
   rename resname BUDM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if na2udmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{na2udmtop} - 1
   rename resname A2UDM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nb2udmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nb2udmtop} - 1
   rename resname B2UDM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naddmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naddmtop} - 1
   rename resname ADDM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbddmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbddmtop} - 1
   rename resname BDDM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nadmhmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadmhmtop} - 1
   rename resname ADMHM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbdmhmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdmhmtop} - 1
   rename resname BDMHM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nappmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nappmtop} - 1
   rename resname APPM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbppmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbppmtop} - 1
   rename resname BPPM select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if natmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{natmtop} - 1
   rename resname ATM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbtmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbtmtop} - 1
   rename resname BTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacy3mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy3mtop} - 1
   rename resname ACY3M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcy3mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy3mtop} - 1
   rename resname BCY3M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacy4mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy4mtop} - 1
   rename resname ACY4M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcy4mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy4mtop} - 1
   rename resname BCY4M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacy5mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy5mtop} - 1
   rename resname ACY5M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcy5mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy5mtop} - 1
   rename resname BCY5M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacy6mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy6mtop} - 1
   rename resname ACY6M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcy6mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy6mtop} - 1
   rename resname BCY6M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nacy7mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy7mtop} - 1
   rename resname ACY7M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbcy7mtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy7mtop} - 1
   rename resname BCY7M select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nnhegtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnhegtop} - 1
   rename resname NHEG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndhegtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhegtop} - 1
   rename resname DHEG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nnmgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnmgtop} - 1
   rename resname NMG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmgtop} - 1
   rename resname DMG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nsmddtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsmddtop} - 1
   rename resname SMDD select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbbphgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbbphgtop} - 1
   rename resname BBPHG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbbcygtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbbcygtop} - 1
   rename resname BBCYG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbogngtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbogngtop} - 1
   rename resname BOGNG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nblmngtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nblmngtop} - 1
   rename resname BLMNG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbdmngtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdmngtop} - 1
   rename resname BDMNG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc5mngtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc5mngtop} - 1
   rename resname C5MNG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nc6mngtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6mngtop} - 1
   rename resname C6MNG select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nahtgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nahtgtop} - 1
   rename resname AHTG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbhtgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbhtgtop} - 1
   rename resname BHTG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naotgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naotgtop} - 1
   rename resname AOTG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbotgtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbotgtop} - 1
   rename resname BOTG select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naotmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naotmtop} - 1
   rename resname AOTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbotmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbotmtop} - 1
   rename resname BOTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nantmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nantmtop} - 1
   rename resname ANTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbntmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbntmtop} - 1
   rename resname BNTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nadtmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadtmtop} - 1
   rename resname ADTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbdtmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdtmtop} - 1
   rename resname BDTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naudtmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naudtmtop} - 1
   rename resname AUDTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbudtmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbudtmtop} - 1
   rename resname BUDTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if naddtmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naddtmtop} - 1
   rename resname ADDTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbddtmtop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbddtmtop} - 1
   rename resname BDDTM select segid UPPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndhpcetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhpcetop} - 1
   rename resname DHPCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopcetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopcetop} - 1
   rename resname POPCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopcetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopcetop} - 1
   rename resname DOPCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpcetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpcetop} - 1
   rename resname DMPCE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if npopeetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopeetop} - 1
   rename resname POPEE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndopeetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopeetop} - 1
   rename resname DOPEE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndppeetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppeetop} - 1
   rename resname DPPEE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmpeetop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpeetop} - 1
   rename resname DMPEE select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if nbmgptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbmgptop} - 1
   rename resname BMGP select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndmtaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmtaptop} - 1
   rename resname DMTAP select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndptaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndptaptop} - 1
   rename resname DPTAP select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndotaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndotaptop} - 1
   rename resname DOTAP select segid UPPO .and. resid @cnt1:@cnt2 end
endif
if ndstaptop .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndstaptop} - 1
   rename resname DSTAP select segid UPPO .and. resid @cnt1:@cnt2 end
endif

!
! Change resnames [lower leaflet]
!

calc cnt1 = 0
calc cnt2 = 0

if nchl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchl1bot} - 1
   rename resname CHL1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nergbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nergbot} - 1
   rename resname ERG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsitobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsitobot} - 1
   rename resname SITO select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nstigbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nstigbot} - 1
   rename resname STIG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nchsdbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchsdbot} - 1
   rename resname CHSD select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nchspbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchspbot} - 1
   rename resname CHSP select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpabot} - 1
   rename resname DLPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpabot} - 1
   rename resname DMPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppabot} - 1
   rename resname DPPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndspabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspabot} - 1
   rename resname DSPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopabot} - 1
   rename resname POPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpabot} - 1
   rename resname PLPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsopabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopabot} - 1
   rename resname SOPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nslpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpabot} - 1
   rename resname SLPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypabot} - 1
   rename resname DYPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nyopabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopabot} - 1
   rename resname YOPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopabot} - 1
   rename resname DOPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpabot} - 1
   rename resname DGPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndepabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepabot} - 1
   rename resname DEPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpabot} - 1
   rename resname DNPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndtpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndtpabot} - 1
   rename resname DTPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntipabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntipabot} - 1
   rename resname TIPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndipabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndipabot} - 1
   rename resname DIPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nllpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpabot} - 1
   rename resname LLPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddpcbot} - 1
   rename resname DDPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndcpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndcpcbot} - 1
   rename resname DCPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpcbot} - 1
   rename resname DLPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpcbot} - 1
   rename resname DMPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppcbot} - 1
   rename resname DPPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndspcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspcbot} - 1
   rename resname DSPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopcbot} - 1
   rename resname POPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpcbot} - 1
   rename resname PLPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npdopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npdopcbot} - 1
   rename resname PDOPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopcbot} - 1
   rename resname SOPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nslpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpcbot} - 1
   rename resname SLPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndrpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndrpcbot} - 1
   rename resname DRPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypcbot} - 1
   rename resname DYPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nyopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopcbot} - 1
   rename resname YOPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopcbot} - 1
   rename resname DOPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndupcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndupcbot} - 1
   rename resname DUPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpcbot} - 1
   rename resname DGPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndepcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepcbot} - 1
   rename resname DEPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddopcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddopcbot} - 1
   rename resname DDOPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpcbot} - 1
   rename resname DNPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlipcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlipcbot} - 1
   rename resname DLIPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nllpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpcbot} - 1
   rename resname LLPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpebot} - 1
   rename resname DLPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpebot} - 1
   rename resname DMPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppebot} - 1
   rename resname DPPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndspebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspebot} - 1
   rename resname DSPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npypebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npypebot} - 1
   rename resname PYPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopebot} - 1
   rename resname POPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpebot} - 1
   rename resname PLPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npdopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npdopebot} - 1
   rename resname PDOPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopebot} - 1
   rename resname SOPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nslpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpebot} - 1
   rename resname SLPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypebot} - 1
   rename resname DYPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nyopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopebot} - 1
   rename resname YOPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if noypebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{noypebot} - 1
   rename resname OYPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopebot} - 1
   rename resname DOPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpebot} - 1
   rename resname DGPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndepebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepebot} - 1
   rename resname DEPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddopebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddopebot} - 1
   rename resname DDOPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpebot} - 1
   rename resname DNPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlipebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlipebot} - 1
   rename resname DLIPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nllpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpebot} - 1
   rename resname LLPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpgbot} - 1
   rename resname DLPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpgbot} - 1
   rename resname DMPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppgbot} - 1
   rename resname DPPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndspgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspgbot} - 1
   rename resname DSPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npypgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npypgbot} - 1
   rename resname PYPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopgbot} - 1
   rename resname POPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpgbot} - 1
   rename resname PLPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsopgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopgbot} - 1
   rename resname SOPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nslpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpgbot} - 1
   rename resname SLPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypgbot} - 1
   rename resname DYPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopgbot} - 1
   rename resname DOPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpgbot} - 1
   rename resname DGPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndepgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepgbot} - 1
   rename resname DEPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpgbot} - 1
   rename resname DNPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlpsbot} - 1
   rename resname DLPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpsbot} - 1
   rename resname DMPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppsbot} - 1
   rename resname DPPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndspsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndspsbot} - 1
   rename resname DSPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopsbot} - 1
   rename resname POPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpsbot} - 1
   rename resname PLPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsopsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsopsbot} - 1
   rename resname SOPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nslpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nslpsbot} - 1
   rename resname SLPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndypsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndypsbot} - 1
   rename resname DYPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nyopsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nyopsbot} - 1
   rename resname YOPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopsbot} - 1
   rename resname DOPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndgpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndgpsbot} - 1
   rename resname DGPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndepsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndepsbot} - 1
   rename resname DEPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddopsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddopsbot} - 1
   rename resname DDOPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndnpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndnpsbot} - 1
   rename resname DNPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nllpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nllpsbot} - 1
   rename resname LLPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopp1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopp1bot} - 1
   rename resname POPP1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopp2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopp2bot} - 1
   rename resname POPP2 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopp3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopp3bot} - 1
   rename resname POPP3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopp1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopp1bot} - 1
   rename resname DOPP1 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopp2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopp2bot} - 1
   rename resname DOPP2 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopp3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopp3bot} - 1
   rename resname DOPP3 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpibot} - 1
   rename resname DMPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi13bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi13bot} - 1
   rename resname DMPI13 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi14bot} - 1
   rename resname DMPI14 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi15bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi15bot} - 1
   rename resname DMPI15 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi24bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi24bot} - 1
   rename resname DMPI24 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi25bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi25bot} - 1
   rename resname DMPI25 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2abot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2abot} - 1
   rename resname DMPI2A select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2bbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2bbot} - 1
   rename resname DMPI2B select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2cbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2cbot} - 1
   rename resname DMPI2C select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi2dbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi2dbot} - 1
   rename resname DMPI2D select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi33bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi33bot} - 1
   rename resname DMPI33 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi34bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi34bot} - 1
   rename resname DMPI34 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpi35bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpi35bot} - 1
   rename resname DMPI35 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npypibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npypibot} - 1
   rename resname PYPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopibot} - 1
   rename resname POPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi13bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi13bot} - 1
   rename resname POPI13 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi14bot} - 1
   rename resname POPI14 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi15bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi15bot} - 1
   rename resname POPI15 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi24bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi24bot} - 1
   rename resname POPI24 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi25bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi25bot} - 1
   rename resname POPI25 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi2abot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2abot} - 1
   rename resname POPI2A select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi2bbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2bbot} - 1
   rename resname POPI2B select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi2cbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2cbot} - 1
   rename resname POPI2C select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi2dbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi2dbot} - 1
   rename resname POPI2D select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi33bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi33bot} - 1
   rename resname POPI33 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi34bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi34bot} - 1
   rename resname POPI34 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopi35bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopi35bot} - 1
   rename resname POPI35 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpibot} - 1
   rename resname PLPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi13bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi13bot} - 1
   rename resname PLPI13 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi14bot} - 1
   rename resname PLPI14 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi15bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi15bot} - 1
   rename resname PLPI15 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi24bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi24bot} - 1
   rename resname PLPI24 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi25bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi25bot} - 1
   rename resname PLPI25 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2abot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2abot} - 1
   rename resname PLPI2A select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2bbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2bbot} - 1
   rename resname PLPI2B select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2cbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2cbot} - 1
   rename resname PLPI2C select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi2dbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi2dbot} - 1
   rename resname PLPI2D select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi33bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi33bot} - 1
   rename resname PLPI33 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi34bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi34bot} - 1
   rename resname PLPI34 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nplpi35bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nplpi35bot} - 1
   rename resname PLPI35 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpibot} - 1
   rename resname PNPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi13bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi13bot} - 1
   rename resname PNPI13 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi14bot} - 1
   rename resname PNPI14 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi15bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi15bot} - 1
   rename resname PNPI15 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi24bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi24bot} - 1
   rename resname PNPI24 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi25bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi25bot} - 1
   rename resname PNPI25 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2abot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2abot} - 1
   rename resname PNPI2A select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2bbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2bbot} - 1
   rename resname PNPI2B select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2cbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2cbot} - 1
   rename resname PNPI2C select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi2dbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi2dbot} - 1
   rename resname PNPI2D select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi33bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi33bot} - 1
   rename resname PNPI33 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi34bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi34bot} - 1
   rename resname PNPI34 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npnpi35bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npnpi35bot} - 1
   rename resname PNPI35 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapibot} - 1
   rename resname SAPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi13bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi13bot} - 1
   rename resname SAPI13 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi14bot} - 1
   rename resname SAPI14 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi15bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi15bot} - 1
   rename resname SAPI15 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi24bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi24bot} - 1
   rename resname SAPI24 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi25bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi25bot} - 1
   rename resname SAPI25 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2abot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2abot} - 1
   rename resname SAPI2A select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2bbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2bbot} - 1
   rename resname SAPI2B select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2cbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2cbot} - 1
   rename resname SAPI2C select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi2dbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi2dbot} - 1
   rename resname SAPI2D select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi33bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi33bot} - 1
   rename resname SAPI33 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi34bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi34bot} - 1
   rename resname SAPI34 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapi35bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapi35bot} - 1
   rename resname SAPI35 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndlipibot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndlipibot} - 1
   rename resname DLIPI select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntmcl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntmcl1bot} - 1
   rename resname TMCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntmcl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntmcl2bot} - 1
   rename resname TMCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npmcl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmcl1bot} - 1
   rename resname PMCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npmcl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmcl2bot} - 1
   rename resname PMCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvcl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npvcl2bot} - 1
   rename resname PVCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntycl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntycl1bot} - 1
   rename resname TYCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntycl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntycl2bot} - 1
   rename resname TYCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntocl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntocl1bot} - 1
   rename resname TOCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntocl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntocl2bot} - 1
   rename resname TOCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nloacl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloacl1bot} - 1
   rename resname LOACL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nloacl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloacl2bot} - 1
   rename resname LOACL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nloccl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloccl1bot} - 1
   rename resname LOCCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nloccl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nloccl2bot} - 1
   rename resname LOCCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntlcl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntlcl1bot} - 1
   rename resname TLCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntlcl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntlcl2bot} - 1
   rename resname TLCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlnccl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnccl1bot} - 1
   rename resname LNCCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlnccl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnccl2bot} - 1
   rename resname LNCCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlnacl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnacl1bot} - 1
   rename resname LNACL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlnacl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnacl2bot} - 1
   rename resname LNACL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlndcl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlndcl1bot} - 1
   rename resname LNDCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlndcl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlndcl2bot} - 1
   rename resname LNDCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlnbcl1bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnbcl1bot} - 1
   rename resname LNBCL1 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlnbcl2bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlnbcl2bot} - 1
   rename resname LNBCL2 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipol2 sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapabot} - 1
   rename resname SAPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapcbot} - 1
   rename resname SAPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapebot} - 1
   rename resname SAPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapgbot} - 1
   rename resname SAPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsapsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsapsbot} - 1
   rename resname SAPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpabot} - 1
   rename resname SDPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpcbot} - 1
   rename resname SDPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpebot} - 1
   rename resname SDPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpgbot} - 1
   rename resname SDPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdpsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdpsbot} - 1
   rename resname SDPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapabot} - 1
   rename resname DAPA select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapcbot} - 1
   rename resname DAPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapebot} - 1
   rename resname DAPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapgbot} - 1
   rename resname DAPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndapsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndapsbot} - 1
   rename resname DAPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntspcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntspcbot} - 1
   rename resname TSPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npsmbot} - 1
   rename resname PSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nssmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nssmbot} - 1
   rename resname SSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nasmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nasmbot} - 1
   rename resname ASM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbsmbot} - 1
   rename resname BSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if n23smbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{n23smbot} - 1
   rename resname 23SM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlsmbot} - 1
   rename resname LSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nosmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nosmbot} - 1
   rename resname OSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nnsmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnsmbot} - 1
   rename resname NSM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer160bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer160bot} - 1
   rename resname CER160 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer180bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer180bot} - 1
   rename resname CER180 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer181bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer181bot} - 1
   rename resname CER181 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer200bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer200bot} - 1
   rename resname CER200 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer220bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer220bot} - 1
   rename resname CER220 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer240bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer240bot} - 1
   rename resname CER240 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer241bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer241bot} - 1
   rename resname CER241 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncer3ebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncer3ebot} - 1
   rename resname CER3E select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nqmpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nqmpebot} - 1
   rename resname QMPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npmpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmpebot} - 1
   rename resname PMPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npmpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npmpgbot} - 1
   rename resname PMPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npppebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npppebot} - 1
   rename resname PPPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvpebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npvpebot} - 1
   rename resname PVPE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npvpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npvpgbot} - 1
   rename resname PVPG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nappcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nappcbot} - 1
   rename resname APPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nippcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nippcbot} - 1
   rename resname IPPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nphpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nphpcbot} - 1
   rename resname PHPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppgkbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppgkbot} - 1
   rename resname DPPGK select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlaubot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlaubot} - 1
   rename resname LAU select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nmyrbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyrbot} - 1
   rename resname MYR select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npalbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npalbot} - 1
   rename resname PAL select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nstebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nstebot} - 1
   rename resname STE select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if narabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{narabot} - 1
   rename resname ARA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbehbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbehbot} - 1
   rename resname BEH select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntribot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntribot} - 1
   rename resname TRI select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlignbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlignbot} - 1
   rename resname LIGN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nmyrobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyrobot} - 1
   rename resname MYRO select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npalobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npalobot} - 1
   rename resname PALO select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhtabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhtabot} - 1
   rename resname HTA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nolebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nolebot} - 1
   rename resname OLE select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlinbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlinbot} - 1
   rename resname LIN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nalinbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nalinbot} - 1
   rename resname ALIN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdabot} - 1
   rename resname SDA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nglabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nglabot} - 1
   rename resname GLA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if neicobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{neicobot} - 1
   rename resname EICO select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nedabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nedabot} - 1
   rename resname EDA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nmeabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmeabot} - 1
   rename resname MEA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndglabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndglabot} - 1
   rename resname DGLA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if netebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{netebot} - 1
   rename resname ETE select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if netabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{netabot} - 1
   rename resname ETA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nepabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nepabot} - 1
   rename resname EPA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naranbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naranbot} - 1
   rename resname ARAN select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhpabot} - 1
   rename resname HPA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nerubot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nerubot} - 1
   rename resname ERU select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddabot} - 1
   rename resname DDA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nadrbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadrbot} - 1
   rename resname ADR select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndptbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndptbot} - 1
   rename resname DPT select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndpabot} - 1
   rename resname DPA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndhabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhabot} - 1
   rename resname DHA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nnerbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnerbot} - 1
   rename resname NER select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nttabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nttabot} - 1
   rename resname TTA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntptbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntptbot} - 1
   rename resname TPT select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntpabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntpabot} - 1
   rename resname TPA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nthabot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nthabot} - 1
   rename resname THA select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlaupbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlaupbot} - 1
   rename resname LAUP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nmyrpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyrpbot} - 1
   rename resname MYRP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npalpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npalpbot} - 1
   rename resname PALP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nstepbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nstepbot} - 1
   rename resname STEP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if narapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{narapbot} - 1
   rename resname ARAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbehpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbehpbot} - 1
   rename resname BEHP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntripbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntripbot} - 1
   rename resname TRIP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlignpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlignpbot} - 1
   rename resname LIGNP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nmyropbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmyropbot} - 1
   rename resname MYROP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npalopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npalopbot} - 1
   rename resname PALOP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhtapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhtapbot} - 1
   rename resname HTAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nolepbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nolepbot} - 1
   rename resname OLEP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlinpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlinpbot} - 1
   rename resname LINP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nalinpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nalinpbot} - 1
   rename resname ALINP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdapbot} - 1
   rename resname SDAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nglapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nglapbot} - 1
   rename resname GLAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if neicopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{neicopbot} - 1
   rename resname EICOP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nedapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nedapbot} - 1
   rename resname EDAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nmeapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nmeapbot} - 1
   rename resname MEAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndglapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndglapbot} - 1
   rename resname DGLAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if netepbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{netepbot} - 1
   rename resname ETEP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if netapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{netapbot} - 1
   rename resname ETAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nepapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nepapbot} - 1
   rename resname EPAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naranpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naranpbot} - 1
   rename resname ARANP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nhpapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nhpapbot} - 1
   rename resname HPAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nerupbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nerupbot} - 1
   rename resname ERUP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddapbot} - 1
   rename resname DDAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nadrpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadrpbot} - 1
   rename resname ADRP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndptpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndptpbot} - 1
   rename resname DPTP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndpapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndpapbot} - 1
   rename resname DPAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndhapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhapbot} - 1
   rename resname DHAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nnerpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnerpbot} - 1
   rename resname NERP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nttapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nttapbot} - 1
   rename resname TTAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntptpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntptpbot} - 1
   rename resname TPTP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntpapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntpapbot} - 1
   rename resname TPAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nthapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nthapbot} - 1
   rename resname THAP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsb3-10bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsb3-10bot} - 1
   rename resname SB3-10 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsb3-12bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsb3-12bot} - 1
   rename resname SB3-12 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsb3-14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsb3-14bot} - 1
   rename resname SB3-14 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nchapsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchapsbot} - 1
   rename resname CHAPS select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nchapsobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nchapsobot} - 1
   rename resname CHAPSO select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddmgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddmgbot} - 1
   rename resname DDMG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndomgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndomgbot} - 1
   rename resname DOMG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddaobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddaobot} - 1
   rename resname DDAO select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nudaobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nudaobot} - 1
   rename resname UDAO select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nldaobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nldaobot} - 1
   rename resname LDAO select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlapaobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlapaobot} - 1
   rename resname LAPAO select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntripaobot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntripaobot} - 1
   rename resname TRIPAO select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfos10bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos10bot} - 1
   rename resname FOS10 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfos12bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos12bot} - 1
   rename resname FOS12 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfos13bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos13bot} - 1
   rename resname FOS13 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfos14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos14bot} - 1
   rename resname FOS14 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfos15bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos15bot} - 1
   rename resname FOS15 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfos16bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfos16bot} - 1
   rename resname FOS16 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nufos10bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nufos10bot} - 1
   rename resname UFOS10 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlpc12bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlpc12bot} - 1
   rename resname LPC12 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlpc14bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlpc14bot} - 1
   rename resname LPC14 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfois9bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfois9bot} - 1
   rename resname FOIS9 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nfois11bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nfois11bot} - 1
   rename resname FOIS11 select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc6dhpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6dhpcbot} - 1
   rename resname C6DHPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc7dhpcbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc7dhpcbot} - 1
   rename resname C7DHPC select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos3bot} - 1
   rename resname CYFOS3 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos4bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos4bot} - 1
   rename resname CYFOS4 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos5bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos5bot} - 1
   rename resname CYFOS5 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos6bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos6bot} - 1
   rename resname CYFOS6 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ncyfos7bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ncyfos7bot} - 1
   rename resname CYFOS7 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsdsbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsdsbot} - 1
   rename resname SDS select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlmpgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlmpgbot} - 1
   rename resname LMPG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlppgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlppgbot} - 1
   rename resname LPPG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nddaopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nddaopbot} - 1
   rename resname DDAOP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nudaopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nudaopbot} - 1
   rename resname UDAOP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nldaopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nldaopbot} - 1
   rename resname LDAOP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nlapaopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nlapaopbot} - 1
   rename resname LAPAOP select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntrpaopbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntrpaopbot} - 1
   rename resname TRPAOP select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc6eg3bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6eg3bot} - 1
   rename resname C6EG3 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc6eg4bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6eg4bot} - 1
   rename resname C6EG4 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc6eg5bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6eg5bot} - 1
   rename resname C6EG5 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc7eg4bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc7eg4bot} - 1
   rename resname C7EG4 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc7eg5bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc7eg5bot} - 1
   rename resname C7EG5 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc8eg4bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc8eg4bot} - 1
   rename resname C8EG4 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc8eg5bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc8eg5bot} - 1
   rename resname C8EG5 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc8eg6bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc8eg6bot} - 1
   rename resname C8EG6 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc10eg5bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc10eg5bot} - 1
   rename resname C10EG5 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc10eg6bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc10eg6bot} - 1
   rename resname C10EG6 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc10eg9bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc10eg9bot} - 1
   rename resname C10EG9 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc12eg7bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12eg7bot} - 1
   rename resname C12EG7 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc12eg8bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12eg8bot} - 1
   rename resname C12EG8 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc12eg9bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12eg9bot} - 1
   rename resname C12EG9 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc12degbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc12degbot} - 1
   rename resname C12DEG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc13eg8bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc13eg8bot} - 1
   rename resname C13EG8 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nnidp40bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnidp40bot} - 1
   rename resname NIDP40 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntx100bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntx100bot} - 1
   rename resname TX100 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ntx114bot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ntx114bot} - 1
   rename resname TX114 select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naogbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naogbot} - 1
   rename resname AOG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbogbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbogbot} - 1
   rename resname BOG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nangbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nangbot} - 1
   rename resname ANG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbngbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbngbot} - 1
   rename resname BNG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nadgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadgbot} - 1
   rename resname ADG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbdgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdgbot} - 1
   rename resname BDG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naddgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naddgbot} - 1
   rename resname ADDG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbddgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbddgbot} - 1
   rename resname BDDG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacy3gbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy3gbot} - 1
   rename resname ACY3G select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcy3gbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy3gbot} - 1
   rename resname BCY3G select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if namhcgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{namhcgbot} - 1
   rename resname AMHCG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbmhcgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbmhcgbot} - 1
   rename resname BMHCG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naombot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naombot} - 1
   rename resname AOM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbombot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbombot} - 1
   rename resname BOM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nanmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nanmbot} - 1
   rename resname ANM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbnmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbnmbot} - 1
   rename resname BNM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nadmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadmbot} - 1
   rename resname ADM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbdmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdmbot} - 1
   rename resname BDM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naudmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naudmbot} - 1
   rename resname AUDM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbudmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbudmbot} - 1
   rename resname BUDM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if na2udmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{na2udmbot} - 1
   rename resname A2UDM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nb2udmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nb2udmbot} - 1
   rename resname B2UDM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naddmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naddmbot} - 1
   rename resname ADDM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbddmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbddmbot} - 1
   rename resname BDDM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nadmhmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadmhmbot} - 1
   rename resname ADMHM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbdmhmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdmhmbot} - 1
   rename resname BDMHM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nappmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nappmbot} - 1
   rename resname APPM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbppmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbppmbot} - 1
   rename resname BPPM select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if natmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{natmbot} - 1
   rename resname ATM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbtmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbtmbot} - 1
   rename resname BTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacy3mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy3mbot} - 1
   rename resname ACY3M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcy3mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy3mbot} - 1
   rename resname BCY3M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacy4mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy4mbot} - 1
   rename resname ACY4M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcy4mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy4mbot} - 1
   rename resname BCY4M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacy5mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy5mbot} - 1
   rename resname ACY5M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcy5mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy5mbot} - 1
   rename resname BCY5M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacy6mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy6mbot} - 1
   rename resname ACY6M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcy6mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy6mbot} - 1
   rename resname BCY6M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nacy7mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nacy7mbot} - 1
   rename resname ACY7M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbcy7mbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbcy7mbot} - 1
   rename resname BCY7M select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nnhegbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnhegbot} - 1
   rename resname NHEG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndhegbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhegbot} - 1
   rename resname DHEG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nnmgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nnmgbot} - 1
   rename resname NMG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmgbot} - 1
   rename resname DMG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nsmddbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nsmddbot} - 1
   rename resname SMDD select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbbphgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbbphgbot} - 1
   rename resname BBPHG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbbcygbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbbcygbot} - 1
   rename resname BBCYG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbogngbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbogngbot} - 1
   rename resname BOGNG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nblmngbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nblmngbot} - 1
   rename resname BLMNG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbdmngbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdmngbot} - 1
   rename resname BDMNG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc5mngbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc5mngbot} - 1
   rename resname C5MNG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nc6mngbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nc6mngbot} - 1
   rename resname C6MNG select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nahtgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nahtgbot} - 1
   rename resname AHTG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbhtgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbhtgbot} - 1
   rename resname BHTG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naotgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naotgbot} - 1
   rename resname AOTG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbotgbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbotgbot} - 1
   rename resname BOTG select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naotmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naotmbot} - 1
   rename resname AOTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbotmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbotmbot} - 1
   rename resname BOTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nantmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nantmbot} - 1
   rename resname ANTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbntmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbntmbot} - 1
   rename resname BNTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nadtmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nadtmbot} - 1
   rename resname ADTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbdtmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbdtmbot} - 1
   rename resname BDTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naudtmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naudtmbot} - 1
   rename resname AUDTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbudtmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbudtmbot} - 1
   rename resname BUDTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if naddtmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{naddtmbot} - 1
   rename resname ADDTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbddtmbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbddtmbot} - 1
   rename resname BDDTM select segid DNPO .and. resid @cnt1:@cnt2 end
   scalar type set @ipolf sele segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndhpcebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndhpcebot} - 1
   rename resname DHPCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopcebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopcebot} - 1
   rename resname POPCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopcebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopcebot} - 1
   rename resname DOPCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpcebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpcebot} - 1
   rename resname DMPCE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if npopeebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{npopeebot} - 1
   rename resname POPEE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndopeebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndopeebot} - 1
   rename resname DOPEE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndppeebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndppeebot} - 1
   rename resname DPPEE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmpeebot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmpeebot} - 1
   rename resname DMPEE select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if nbmgpbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{nbmgpbot} - 1
   rename resname BMGP select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndmtapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndmtapbot} - 1
   rename resname DMTAP select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndptapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndptapbot} - 1
   rename resname DPTAP select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndotapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndotapbot} - 1
   rename resname DOTAP select segid DNPO .and. resid @cnt1:@cnt2 end
endif
if ndstapbot .gt. 0 then
   calc cnt1 = @cnt2 + 1
   calc cnt2 = @cnt1 + @{ndstapbot} - 1
   rename resname DSTAP select segid DNPO .and. resid @cnt1:@cnt2 end
endif

! charged lipids
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dlpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dmpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dppa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dspa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname popa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname plpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sopa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname slpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dypa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname yopa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dopa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dgpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname depa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dnpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dtpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tipa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dipa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname llpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dlpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dmpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dppg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dspg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pypg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname popg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname plpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sopg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname slpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dypg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dopg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dgpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname depg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dnpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dlps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dmps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dpps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dsps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pops end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname plps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sops end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname slps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dyps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname yops end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dops end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dgps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname deps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname ddops end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dnps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname llps end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname popp1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname popp2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname popp3 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname dopp1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname dopp2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dopp3 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dmpi end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname dmpi13 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname dmpi14 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname dmpi15 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname dmpi24 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname dmpi25 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname dmpi2a end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname dmpi2b end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname dmpi2c end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname dmpi2d end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname dmpi33 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname dmpi34 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname dmpi35 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pypi end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname popi end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname popi13 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname popi14 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname popi15 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname popi24 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname popi25 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname popi2a end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname popi2b end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname popi2c end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname popi2d end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname popi33 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname popi34 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname popi35 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname plpi end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname plpi13 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname plpi14 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname plpi15 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname plpi24 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname plpi25 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname plpi2a end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname plpi2b end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname plpi2c end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname plpi2d end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname plpi33 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname plpi34 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname plpi35 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pnpi end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname pnpi13 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname pnpi14 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname pnpi15 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname pnpi24 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname pnpi25 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname pnpi2a end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname pnpi2b end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname pnpi2c end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname pnpi2d end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname pnpi33 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname pnpi34 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname pnpi35 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sapi end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname sapi13 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname sapi14 end
scalar charge set -3 sele (segid UPPO .or. segid DNPO) .and. resname sapi15 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname sapi24 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname sapi25 end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname sapi2a end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname sapi2b end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname sapi2c end
scalar charge set -4 sele (segid UPPO .or. segid DNPO) .and. resname sapi2d end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname sapi33 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname sapi34 end
scalar charge set -6 sele (segid UPPO .or. segid DNPO) .and. resname sapi35 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dlipi end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tmcl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname tmcl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pmcl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname pmcl2 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname pvcl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tycl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname tycl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tocl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname tocl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname loacl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname loacl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname loccl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname loccl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tlcl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname tlcl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lnccl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname lnccl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lnacl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname lnacl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lndcl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname lndcl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lnbcl1 end
scalar charge set -2 sele (segid UPPO .or. segid DNPO) .and. resname lnbcl2 end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sapa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sapg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname saps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sdpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sdpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sdps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dapa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dapg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname daps end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pmpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pvpg end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname dppgk end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lau end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname myr end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname pal end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname ste end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname ara end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname beh end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tri end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lign end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname myro end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname palo end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname hta end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname ole end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lin end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname alin end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sda end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname gla end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname eico end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname eda end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname mea end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dgla end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname ete end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname eta end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname epa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname aran end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname hpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname eru end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dda end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname adr end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dpt end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname dha end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname ner end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tta end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tpt end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tpa end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname tha end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname sds end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lmpg end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname lppg end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname ddaop end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname udaop end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname ldaop end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname lapaop end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname trpaop end
scalar charge set -1 sele (segid UPPO .or. segid DNPO) .and. resname bmgp end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname dmtap end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname dptap end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname dotap end
scalar charge set 1 sele (segid UPPO .or. segid DNPO) .and. resname dstap end

! First, guess available regions for initial positions of the big-spheres (150%)
calc Ainit = @A * 1.5
calc Binit = @B * 1.5

! Define the boundary for non-accessible regions of the big-spheres
define uppo sele ( .not. ( segid UPPO .or. segid DNPO ) ) .and. -
                 ( prop Z .gt.  10 ) .and. (prop Z .lt.  20 ) .and. .not. hydrogen end
if ?nsel .gt. 0 then
   coor stat sele uppo end
   calc xpup = ?xmax
   calc xnup = ?xmin
   calc ypup = ?ymax
   calc ynup = ?ymin
else
   calc xpup = 0
   calc xnup = 0
   calc ypup = 0
   calc ynup = 0
endif

define dnpo sele ( .not. ( segid UPPO .or. segid DNPO ) ) .and. -
                 ( prop Z .gt. -20 ) .and. (prop Z .lt. -10 ) .and. .not. hydrogen end
if ?nsel .gt. 0 then
   coor stat sele dnpo end
   calc xpdn = ?xmax
   calc xndn = ?xmin
   calc ypdn = ?ymax
   calc yndn = ?ymin
else
   calc xpdn = 0
   calc xndn = 0
   calc ypdn = 0
   calc yndn = 0
endif

! to prevent infinite-loop
calc A2 = @A/2
calc B2 = @A/2
if xpup .gt.  @A2 stop
if xnup .lt. -@A2 stop
if ypup .gt.  @B2 stop
if ynup .lt. -@B2 stop
if xpdn .gt.  @A2 stop
if xndn .lt. -@A2 stop
if ypdn .gt.  @B2 stop
if yndn .lt. -@B2 stop

!----------------------------------------------------------------------
! Put big-spheres molecules at random positions

! Random number generation
RAND UNIF ISEED 1572958006 SCALE 1.0

calc i = 1

label do_up

  label rand_up
  calc xpos = ?random
  calc ypos = ?random
  calc xpos = @Ainit * ( @xpos - 0.5 )
  calc ypos = @Binit * ( @ypos - 0.5 )

  set iprot = 1
  label check_prot_up
     define XXX sele uppo .and. iseg @iprot end
     if ?nsel .gt. 0 then
        coor stat sele XXX end
        calc xpup = ?xmax + 5
        calc xnup = ?xmin - 5
        calc ypup = ?ymax + 5
        calc ynup = ?ymin - 5
     else
        calc xpup = 0
        calc xnup = 0
        calc ypup = 0
        calc ynup = 0
     endif
     if xpos .gt. @xnup if xpos .lt. @xpup if ypos .gt. @ynup if ypos .lt. @ypup goto rand_up
     incr iprot by 1
  if iprot .le. @nprot goto check_prot_up

  calc zpos = 12.0 

  coor set xdir @xpos  ydir @ypos  zdir @zpos select segid UPPO .and. resid @i end

  MMFP
  GEO plane  RCM -
      xref 0.0  yref 0.0  zref  @zpos  zdir 1.0 -
      force  100.0   select segid UPPO .and. resi @i end
  END

incr i by 1
if i le @NLIPTOP goto do_up


calc i = 1

label do_dn

  label rand_dn
  calc xpos = ?random
  calc ypos = ?random
  calc xpos = @Ainit * ( @xpos - 0.5 )
  calc ypos = @Binit * ( @ypos - 0.5 )

  set iprot = 1
  label check_prot_dn
     define XXX sele dnpo .and. iseg @iprot end
     if ?nsel .gt. 0 then
        coor stat sele XXX end
        calc xpdn = ?xmax + 5
        calc xndn = ?xmin - 5
        calc ypdn = ?ymax + 5
        calc yndn = ?ymin - 5
     else
        calc xpdn = 0
        calc xndn = 0
        calc ypdn = 0
        calc yndn = 0
     endif
     if xpos .gt. @xndn if xpos .lt. @xpdn if ypos .gt. @yndn if ypos .lt. @ypdn goto rand_dn
     incr iprot by 1
  if iprot .le. @nprot goto check_prot_dn

  calc zpos = -12.0 

  coor set xdir @xpos  ydir @ypos  zdir @zpos select segid DNPO .and. resid @i end

  MMFP
  GEO plane  RCM -
      xref 0.0  yref 0.0  zref  @zpos  zdir 1.0 -
      force  100.0   select segid DNPO .and. resi @i end
  END

incr i by 1
if i le @NLIPBOT goto do_dn

rename SEGid HEAD sele segid UPPO end
join HEAD DNPO renumber

!------------------------------------------------------------------------------
! Build the Periodic Boundary Conditions and
! Carry out Minimization and Dynamics for Equilibration of Large Spheres
! 6 cycles to reduce the Ainit and Binit back to original A and B

cons fix sele .not. segid HEAD end

! LD simulation steps depend on the number of lipid spheres
calc nstep = int ( ( @NLIPTOP + @NLIPBOT ) * 4 / 1000 + 1 ) * 1000

set factor = 1.5

label do_packing

calc Ainit = @A * @factor
calc Binit = @B * @factor

if factor .ne. 1.5 crystal free
crystal define @xtltype @Ainit @Binit 10000.0 @Alpha @beta @Gamma

open read unit 10 card name crystal_image.str
crystal read unit 10 card
close unit 10

image byresid xcen 0.0 ycen 0.0 zcen 0.0 sele segid HEAD end

!setup nonbond option (eps=80)
nbonds atom switch cdie vdw vfswitch  -
       ctonnb 20.0 ctofnb 22.0 cutnb 26.0 cutim 26.0 -
       inbfrq -1 imgfrq -1 wmin 1.0 cdie eps 80.0

ENERGY

mini sd   nstep 200    nprint 10
mini abnr nstep 200    nprint 10

scalar fbeta set  1.0 select all end

DYNAMICS  start       nstep   @nstep  timestp  0.001 iprfrq   1000  nprint 100  -
          iasvel    1 firstt 300.0  finalt   300.0 tstruc  300.0  -
          langevin    tbath  300.0  rbuf       0.0 -
          inbfrq   -1 imgfrq    -1  ihbfrq       0 ilbfrq      0  -
          iunread  -1  -
          iunwrite -1  -
          iuncrd   -1 nsavcrd    0  -
          iunvelo  -1 nsavvelo   0  -
          kunit    -1  

decrease factor by 0.1
if factor .ge. 1 goto do_packing

updat cutim 35.0 imall

open write card unit 1 name step3_packing.pdb
write coor pdb  unit 1 image
close unit 1

!
! HEAD ONLY
!

crystal free
define junk sele .not. segid HEAD end
if ?nsel .ne. 0 delete atom sele junk end

open write card unit 10 name step3_packing_head.crd
write coor card unit 10

open write card unit 10 name step3_packing_head.pdb
write coor pdb  unit 10

open write unit 10 card name step3_packing_head.psf
write psf  unit 10 card

stop
