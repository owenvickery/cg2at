* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v2.0 on Nov, 01. 2019. JOBID=157262154737
* DETERMINE THE SYSTEM SIZE IN XY 
* 

DIMENS CHSIZE 3000000 MAXRES 3000000

! Read topology and parameter files
stream toppar.str

set toparea = 0
set botarea = 0
set protZmax = 0
set protZmin = 0

set BOXTYPE = rect
set Alpha = 90.0
set Beta  = 90.0
set Gamma = 90.0

set liptoparea = 59
set lipbotarea = 59
set nliptop    = 1
set nlipbot    = 1

calc LXYtop = sqrt( @liptoparea + @toparea )
calc LXYbot = sqrt( @lipbotarea + @botarea )
calc LXY    = ( @LXYtop + @LXYbot ) / 2

! allow 5% difference along X and Y
calc XvsY = 1
if XvsY .lt. 1.05 if XvsY .gt. 0.95 calc XvsY = 1
calc B = sqrt( @LXY * @LXY / @XvsY )
calc A = @XvsY * @B

set XTLtype = ORTHorhombic
if A .eq. @B set XTLtype = TETRagonal

! Z value determination
calc lipboxZhalf = 20

if protZmax .lt.  @lipboxZhalf set protZmax =  @lipboxZhalf
if protZmin .gt. -@lipboxZhalf set protZmin = -@lipboxZhalf

! water layer from protein top and bottom
calc wboxZ = 22.5

calc propzup = @protZmax + @wboxZ
calc propzdn = @protZmin - @wboxZ

calc watZup = 0
calc watZdn = 0
if propzup .ge.  @lipboxZhalf calc watZup =   @propzup - @lipboxZhalf
if propzdn .lt. -@lipboxZhalf calc watZdn = - @propzdn - @lipboxZhalf

calc boxsizeZ = @lipboxZhalf * 2 + @watZup + @watZdn
calc zcen = ( @watZup - @watZdn ) / 2.0

calc watboxZ = @watZup
if watZup .lt. @watZdn calc watboxZ = @watZdn

calc ncharge = 0
stream step3_nlipids_upper.prm
stream step3_nlipids_lower.prm

calc ncharge = @ncharge + -1 * ( @ndlpatop + @ndlpabot )
calc ncharge = @ncharge + -1 * ( @ndmpatop + @ndmpabot )
calc ncharge = @ncharge + -1 * ( @ndppatop + @ndppabot )
calc ncharge = @ncharge + -1 * ( @ndspatop + @ndspabot )
calc ncharge = @ncharge + -1 * ( @npopatop + @npopabot )
calc ncharge = @ncharge + -1 * ( @nplpatop + @nplpabot )
calc ncharge = @ncharge + -1 * ( @nsopatop + @nsopabot )
calc ncharge = @ncharge + -1 * ( @nslpatop + @nslpabot )
calc ncharge = @ncharge + -1 * ( @ndypatop + @ndypabot )
calc ncharge = @ncharge + -1 * ( @nyopatop + @nyopabot )
calc ncharge = @ncharge + -1 * ( @ndopatop + @ndopabot )
calc ncharge = @ncharge + -1 * ( @ndgpatop + @ndgpabot )
calc ncharge = @ncharge + -1 * ( @ndepatop + @ndepabot )
calc ncharge = @ncharge + -1 * ( @ndnpatop + @ndnpabot )
calc ncharge = @ncharge + -1 * ( @ndtpatop + @ndtpabot )
calc ncharge = @ncharge + -1 * ( @ntipatop + @ntipabot )
calc ncharge = @ncharge + -1 * ( @ndipatop + @ndipabot )
calc ncharge = @ncharge + -1 * ( @nllpatop + @nllpabot )
calc ncharge = @ncharge + -1 * ( @ndlpgtop + @ndlpgbot )
calc ncharge = @ncharge + -1 * ( @ndmpgtop + @ndmpgbot )
calc ncharge = @ncharge + -1 * ( @ndppgtop + @ndppgbot )
calc ncharge = @ncharge + -1 * ( @ndspgtop + @ndspgbot )
calc ncharge = @ncharge + -1 * ( @npypgtop + @npypgbot )
calc ncharge = @ncharge + -1 * ( @npopgtop + @npopgbot )
calc ncharge = @ncharge + -1 * ( @nplpgtop + @nplpgbot )
calc ncharge = @ncharge + -1 * ( @nsopgtop + @nsopgbot )
calc ncharge = @ncharge + -1 * ( @nslpgtop + @nslpgbot )
calc ncharge = @ncharge + -1 * ( @ndypgtop + @ndypgbot )
calc ncharge = @ncharge + -1 * ( @ndopgtop + @ndopgbot )
calc ncharge = @ncharge + -1 * ( @ndgpgtop + @ndgpgbot )
calc ncharge = @ncharge + -1 * ( @ndepgtop + @ndepgbot )
calc ncharge = @ncharge + -1 * ( @ndnpgtop + @ndnpgbot )
calc ncharge = @ncharge + -1 * ( @ndlpstop + @ndlpsbot )
calc ncharge = @ncharge + -1 * ( @ndmpstop + @ndmpsbot )
calc ncharge = @ncharge + -1 * ( @ndppstop + @ndppsbot )
calc ncharge = @ncharge + -1 * ( @ndspstop + @ndspsbot )
calc ncharge = @ncharge + -1 * ( @npopstop + @npopsbot )
calc ncharge = @ncharge + -1 * ( @nplpstop + @nplpsbot )
calc ncharge = @ncharge + -1 * ( @nsopstop + @nsopsbot )
calc ncharge = @ncharge + -1 * ( @nslpstop + @nslpsbot )
calc ncharge = @ncharge + -1 * ( @ndypstop + @ndypsbot )
calc ncharge = @ncharge + -1 * ( @nyopstop + @nyopsbot )
calc ncharge = @ncharge + -1 * ( @ndopstop + @ndopsbot )
calc ncharge = @ncharge + -1 * ( @ndgpstop + @ndgpsbot )
calc ncharge = @ncharge + -1 * ( @ndepstop + @ndepsbot )
calc ncharge = @ncharge + -1 * ( @nddopstop + @nddopsbot )
calc ncharge = @ncharge + -1 * ( @ndnpstop + @ndnpsbot )
calc ncharge = @ncharge + -1 * ( @nllpstop + @nllpsbot )
calc ncharge = @ncharge + -2 * ( @npopp1top + @npopp1bot )
calc ncharge = @ncharge + -2 * ( @npopp2top + @npopp2bot )
calc ncharge = @ncharge + -1 * ( @npopp3top + @npopp3bot )
calc ncharge = @ncharge + -2 * ( @ndopp1top + @ndopp1bot )
calc ncharge = @ncharge + -2 * ( @ndopp2top + @ndopp2bot )
calc ncharge = @ncharge + -1 * ( @ndopp3top + @ndopp3bot )
calc ncharge = @ncharge + -1 * ( @ndmpitop + @ndmpibot )
calc ncharge = @ncharge + -3 * ( @ndmpi13top + @ndmpi13bot )
calc ncharge = @ncharge + -3 * ( @ndmpi14top + @ndmpi14bot )
calc ncharge = @ncharge + -3 * ( @ndmpi15top + @ndmpi15bot )
calc ncharge = @ncharge + -4 * ( @ndmpi24top + @ndmpi24bot )
calc ncharge = @ncharge + -4 * ( @ndmpi25top + @ndmpi25bot )
calc ncharge = @ncharge + -4 * ( @ndmpi2atop + @ndmpi2abot )
calc ncharge = @ncharge + -4 * ( @ndmpi2btop + @ndmpi2bbot )
calc ncharge = @ncharge + -4 * ( @ndmpi2ctop + @ndmpi2cbot )
calc ncharge = @ncharge + -4 * ( @ndmpi2dtop + @ndmpi2dbot )
calc ncharge = @ncharge + -6 * ( @ndmpi33top + @ndmpi33bot )
calc ncharge = @ncharge + -6 * ( @ndmpi34top + @ndmpi34bot )
calc ncharge = @ncharge + -6 * ( @ndmpi35top + @ndmpi35bot )
calc ncharge = @ncharge + -1 * ( @npypitop + @npypibot )
calc ncharge = @ncharge + -1 * ( @npopitop + @npopibot )
calc ncharge = @ncharge + -3 * ( @npopi13top + @npopi13bot )
calc ncharge = @ncharge + -3 * ( @npopi14top + @npopi14bot )
calc ncharge = @ncharge + -3 * ( @npopi15top + @npopi15bot )
calc ncharge = @ncharge + -4 * ( @npopi24top + @npopi24bot )
calc ncharge = @ncharge + -4 * ( @npopi25top + @npopi25bot )
calc ncharge = @ncharge + -4 * ( @npopi2atop + @npopi2abot )
calc ncharge = @ncharge + -4 * ( @npopi2btop + @npopi2bbot )
calc ncharge = @ncharge + -4 * ( @npopi2ctop + @npopi2cbot )
calc ncharge = @ncharge + -4 * ( @npopi2dtop + @npopi2dbot )
calc ncharge = @ncharge + -6 * ( @npopi33top + @npopi33bot )
calc ncharge = @ncharge + -6 * ( @npopi34top + @npopi34bot )
calc ncharge = @ncharge + -6 * ( @npopi35top + @npopi35bot )
calc ncharge = @ncharge + -1 * ( @nplpitop + @nplpibot )
calc ncharge = @ncharge + -3 * ( @nplpi13top + @nplpi13bot )
calc ncharge = @ncharge + -3 * ( @nplpi14top + @nplpi14bot )
calc ncharge = @ncharge + -3 * ( @nplpi15top + @nplpi15bot )
calc ncharge = @ncharge + -4 * ( @nplpi24top + @nplpi24bot )
calc ncharge = @ncharge + -4 * ( @nplpi25top + @nplpi25bot )
calc ncharge = @ncharge + -4 * ( @nplpi2atop + @nplpi2abot )
calc ncharge = @ncharge + -4 * ( @nplpi2btop + @nplpi2bbot )
calc ncharge = @ncharge + -4 * ( @nplpi2ctop + @nplpi2cbot )
calc ncharge = @ncharge + -4 * ( @nplpi2dtop + @nplpi2dbot )
calc ncharge = @ncharge + -6 * ( @nplpi33top + @nplpi33bot )
calc ncharge = @ncharge + -6 * ( @nplpi34top + @nplpi34bot )
calc ncharge = @ncharge + -6 * ( @nplpi35top + @nplpi35bot )
calc ncharge = @ncharge + -1 * ( @npnpitop + @npnpibot )
calc ncharge = @ncharge + -3 * ( @npnpi13top + @npnpi13bot )
calc ncharge = @ncharge + -3 * ( @npnpi14top + @npnpi14bot )
calc ncharge = @ncharge + -3 * ( @npnpi15top + @npnpi15bot )
calc ncharge = @ncharge + -4 * ( @npnpi24top + @npnpi24bot )
calc ncharge = @ncharge + -4 * ( @npnpi25top + @npnpi25bot )
calc ncharge = @ncharge + -4 * ( @npnpi2atop + @npnpi2abot )
calc ncharge = @ncharge + -4 * ( @npnpi2btop + @npnpi2bbot )
calc ncharge = @ncharge + -4 * ( @npnpi2ctop + @npnpi2cbot )
calc ncharge = @ncharge + -4 * ( @npnpi2dtop + @npnpi2dbot )
calc ncharge = @ncharge + -6 * ( @npnpi33top + @npnpi33bot )
calc ncharge = @ncharge + -6 * ( @npnpi34top + @npnpi34bot )
calc ncharge = @ncharge + -6 * ( @npnpi35top + @npnpi35bot )
calc ncharge = @ncharge + -1 * ( @nsapitop + @nsapibot )
calc ncharge = @ncharge + -3 * ( @nsapi13top + @nsapi13bot )
calc ncharge = @ncharge + -3 * ( @nsapi14top + @nsapi14bot )
calc ncharge = @ncharge + -3 * ( @nsapi15top + @nsapi15bot )
calc ncharge = @ncharge + -4 * ( @nsapi24top + @nsapi24bot )
calc ncharge = @ncharge + -4 * ( @nsapi25top + @nsapi25bot )
calc ncharge = @ncharge + -4 * ( @nsapi2atop + @nsapi2abot )
calc ncharge = @ncharge + -4 * ( @nsapi2btop + @nsapi2bbot )
calc ncharge = @ncharge + -4 * ( @nsapi2ctop + @nsapi2cbot )
calc ncharge = @ncharge + -4 * ( @nsapi2dtop + @nsapi2dbot )
calc ncharge = @ncharge + -6 * ( @nsapi33top + @nsapi33bot )
calc ncharge = @ncharge + -6 * ( @nsapi34top + @nsapi34bot )
calc ncharge = @ncharge + -6 * ( @nsapi35top + @nsapi35bot )
calc ncharge = @ncharge + -1 * ( @ndlipitop + @ndlipibot )
calc ncharge = @ncharge + -1 * ( @ntmcl1top + @ntmcl1bot )
calc ncharge = @ncharge + -2 * ( @ntmcl2top + @ntmcl2bot )
calc ncharge = @ncharge + -1 * ( @npmcl1top + @npmcl1bot )
calc ncharge = @ncharge + -2 * ( @npmcl2top + @npmcl2bot )
calc ncharge = @ncharge + -2 * ( @npvcl2top + @npvcl2bot )
calc ncharge = @ncharge + -1 * ( @ntycl1top + @ntycl1bot )
calc ncharge = @ncharge + -2 * ( @ntycl2top + @ntycl2bot )
calc ncharge = @ncharge + -1 * ( @ntocl1top + @ntocl1bot )
calc ncharge = @ncharge + -2 * ( @ntocl2top + @ntocl2bot )
calc ncharge = @ncharge + -1 * ( @nloacl1top + @nloacl1bot )
calc ncharge = @ncharge + -2 * ( @nloacl2top + @nloacl2bot )
calc ncharge = @ncharge + -1 * ( @nloccl1top + @nloccl1bot )
calc ncharge = @ncharge + -2 * ( @nloccl2top + @nloccl2bot )
calc ncharge = @ncharge + -1 * ( @ntlcl1top + @ntlcl1bot )
calc ncharge = @ncharge + -2 * ( @ntlcl2top + @ntlcl2bot )
calc ncharge = @ncharge + -1 * ( @nlnccl1top + @nlnccl1bot )
calc ncharge = @ncharge + -2 * ( @nlnccl2top + @nlnccl2bot )
calc ncharge = @ncharge + -1 * ( @nlnacl1top + @nlnacl1bot )
calc ncharge = @ncharge + -2 * ( @nlnacl2top + @nlnacl2bot )
calc ncharge = @ncharge + -1 * ( @nlndcl1top + @nlndcl1bot )
calc ncharge = @ncharge + -2 * ( @nlndcl2top + @nlndcl2bot )
calc ncharge = @ncharge + -1 * ( @nlnbcl1top + @nlnbcl1bot )
calc ncharge = @ncharge + -2 * ( @nlnbcl2top + @nlnbcl2bot )
calc ncharge = @ncharge + -1 * ( @nsapatop + @nsapabot )
calc ncharge = @ncharge + -1 * ( @nsapgtop + @nsapgbot )
calc ncharge = @ncharge + -1 * ( @nsapstop + @nsapsbot )
calc ncharge = @ncharge + -1 * ( @nsdpatop + @nsdpabot )
calc ncharge = @ncharge + -1 * ( @nsdpgtop + @nsdpgbot )
calc ncharge = @ncharge + -1 * ( @nsdpstop + @nsdpsbot )
calc ncharge = @ncharge + -1 * ( @ndapatop + @ndapabot )
calc ncharge = @ncharge + -1 * ( @ndapgtop + @ndapgbot )
calc ncharge = @ncharge + -1 * ( @ndapstop + @ndapsbot )
calc ncharge = @ncharge + -1 * ( @npmpgtop + @npmpgbot )
calc ncharge = @ncharge + -1 * ( @npvpgtop + @npvpgbot )
calc ncharge = @ncharge + 1 * ( @ndppgktop + @ndppgkbot )
calc ncharge = @ncharge + -1 * ( @nlautop + @nlaubot )
calc ncharge = @ncharge + -1 * ( @nmyrtop + @nmyrbot )
calc ncharge = @ncharge + -1 * ( @npaltop + @npalbot )
calc ncharge = @ncharge + -1 * ( @nstetop + @nstebot )
calc ncharge = @ncharge + -1 * ( @naratop + @narabot )
calc ncharge = @ncharge + -1 * ( @nbehtop + @nbehbot )
calc ncharge = @ncharge + -1 * ( @ntritop + @ntribot )
calc ncharge = @ncharge + -1 * ( @nligntop + @nlignbot )
calc ncharge = @ncharge + -1 * ( @nmyrotop + @nmyrobot )
calc ncharge = @ncharge + -1 * ( @npalotop + @npalobot )
calc ncharge = @ncharge + -1 * ( @nhtatop + @nhtabot )
calc ncharge = @ncharge + -1 * ( @noletop + @nolebot )
calc ncharge = @ncharge + -1 * ( @nlintop + @nlinbot )
calc ncharge = @ncharge + -1 * ( @nalintop + @nalinbot )
calc ncharge = @ncharge + -1 * ( @nsdatop + @nsdabot )
calc ncharge = @ncharge + -1 * ( @nglatop + @nglabot )
calc ncharge = @ncharge + -1 * ( @neicotop + @neicobot )
calc ncharge = @ncharge + -1 * ( @nedatop + @nedabot )
calc ncharge = @ncharge + -1 * ( @nmeatop + @nmeabot )
calc ncharge = @ncharge + -1 * ( @ndglatop + @ndglabot )
calc ncharge = @ncharge + -1 * ( @netetop + @netebot )
calc ncharge = @ncharge + -1 * ( @netatop + @netabot )
calc ncharge = @ncharge + -1 * ( @nepatop + @nepabot )
calc ncharge = @ncharge + -1 * ( @narantop + @naranbot )
calc ncharge = @ncharge + -1 * ( @nhpatop + @nhpabot )
calc ncharge = @ncharge + -1 * ( @nerutop + @nerubot )
calc ncharge = @ncharge + -1 * ( @nddatop + @nddabot )
calc ncharge = @ncharge + -1 * ( @nadrtop + @nadrbot )
calc ncharge = @ncharge + -1 * ( @ndpttop + @ndptbot )
calc ncharge = @ncharge + -1 * ( @ndpatop + @ndpabot )
calc ncharge = @ncharge + -1 * ( @ndhatop + @ndhabot )
calc ncharge = @ncharge + -1 * ( @nnertop + @nnerbot )
calc ncharge = @ncharge + -1 * ( @nttatop + @nttabot )
calc ncharge = @ncharge + -1 * ( @ntpttop + @ntptbot )
calc ncharge = @ncharge + -1 * ( @ntpatop + @ntpabot )
calc ncharge = @ncharge + -1 * ( @nthatop + @nthabot )
calc ncharge = @ncharge + -1 * ( @nsdstop + @nsdsbot )
calc ncharge = @ncharge + -1 * ( @nlmpgtop + @nlmpgbot )
calc ncharge = @ncharge + -1 * ( @nlppgtop + @nlppgbot )
calc ncharge = @ncharge + 1 * ( @nddaoptop + @nddaopbot )
calc ncharge = @ncharge + 1 * ( @nudaoptop + @nudaopbot )
calc ncharge = @ncharge + 1 * ( @nldaoptop + @nldaopbot )
calc ncharge = @ncharge + 1 * ( @nlapaoptop + @nlapaopbot )
calc ncharge = @ncharge + 1 * ( @ntrpaoptop + @ntrpaopbot )
calc ncharge = @ncharge + -1 * ( @nbmgptop + @nbmgpbot )
calc ncharge = @ncharge + 1 * ( @ndmtaptop + @ndmtapbot )
calc ncharge = @ncharge + 1 * ( @ndptaptop + @ndptapbot )
calc ncharge = @ncharge + 1 * ( @ndotaptop + @ndotapbot )
calc ncharge = @ncharge + 1 * ( @ndstaptop + @ndstapbot )

open write card  unit 51 name step3_size.str
write title unit 51
* set BOXtype  = @BOXtype
* set XTLtype  = @XTLtype
* set A        = @A
* set B        = @B
* set C        = @boxsizez
* set Alpha    = @Alpha
* set Beta     = @Beta
* set Gamma    = @Gamma
* set Zcen     = @zcen
* set NLIPTOP  = @nliptop
* set NLIPBOT  = @nlipbot
* set wboxZ    = @wboxZ
* set watboxZ  = @watboxZ
* set ncharge  = @ncharge
*

stop
