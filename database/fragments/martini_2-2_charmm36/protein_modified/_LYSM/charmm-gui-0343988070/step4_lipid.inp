* GENERATED BY CHARMM-GUI (http://www.charmm-gui.org) v3.1 on Oct, 23. 2020. JOBID=0343988070
* GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
*

DIMENS CHSIZE 5000000 MAXRES 3000000

! Read topology and parameter files
stream toppar.str

! Read PSF and Coordinates
open read unit 10 card name step1_pdbreader.psf
read psf  unit 10 card

open read unit 10 card name step2_orient.crd
read coor unit 10 card

define PROT sele all end

! Read the system information
stream step3_size.str
stream step3_packing_pol.str

! Read HEAD spheres
! Read PSF and Coordinates
open read unit 10 card name step3_packing_head.psf
read psf  unit 10 card append

open read unit 10 card name step3_packing_head.crd
read coor unit 10 card append

calc Nlipid = @nliptop + @nlipbot

define STEROL sele ( resn CHL1 .or. resn ERG .or. resn SITO .or. resn STIG .or. resn CHSD -
                 .or. resn CHSP .or. resn CAMP .or. resn GCAMP .or. resn GSITO .or. resn GSTIG -
                 .or. resn LANO .or. resn PGCAMP .or. resn PGSITO .or. resn PGSTIG ) end
set nsterol = ?nsel

coor stat

! dummy atom for a ring center
read sequence dum 1
generate dum setup first none last none
coor set xdir 9000.0 ydir 9000.0 zdir 9000.0 sele segid dum end

!==============================================================================
! Sorting the lipid spheres (resids) according to their distance to the protein.
! headgroups with rings (cholesterol, inositol) are not changed.
!

! Top leaflet
!
set LipidNum = 1
label dosort1

   coor stat sele segid head .and. resid @LipidNum end
   set resn1 = ?selresn
   if resn1 .eq. CHL1   goto doskip1
   if resn1 .eq. ERG    goto doskip1
   if resn1 .eq. SITO   goto doskip1
   if resn1 .eq. STIG   goto doskip1
   if resn1 .eq. CHSD   goto doskip1
   if resn1 .eq. CHSP   goto doskip1
   if resn1 .eq. CAMP   goto doskip1
   if resn1 .eq. GCAMP  goto doskip1
   if resn1 .eq. GSITO  goto doskip1
   if resn1 .eq. GSTIG  goto doskip1
   if resn1 .eq. LANO   goto doskip1
   if resn1 .eq. PGCAMP goto doskip1
   if resn1 .eq. PGSITO goto doskip1
   if resn1 .eq. PGSTIG goto doskip1
   if resn1 .eq. DMPI   goto doskip1
   if resn1 .eq. DMPI13 goto doskip1
   if resn1 .eq. DMPI14 goto doskip1
   if resn1 .eq. DMPI15 goto doskip1
   if resn1 .eq. DMPI24 goto doskip1
   if resn1 .eq. DMPI25 goto doskip1
   if resn1 .eq. DMPI2A goto doskip1
   if resn1 .eq. DMPI2B goto doskip1
   if resn1 .eq. DMPI2C goto doskip1
   if resn1 .eq. DMPI2D goto doskip1
   if resn1 .eq. DMPI33 goto doskip1
   if resn1 .eq. DMPI34 goto doskip1
   if resn1 .eq. DMPI35 goto doskip1
   if resn1 .eq. DPPI   goto doskip1
   if resn1 .eq. PYPI   goto doskip1
   if resn1 .eq. PSPI   goto doskip1
   if resn1 .eq. POPI   goto doskip1
   if resn1 .eq. POPI13 goto doskip1
   if resn1 .eq. POPI14 goto doskip1
   if resn1 .eq. POPI15 goto doskip1
   if resn1 .eq. POPI24 goto doskip1
   if resn1 .eq. POPI25 goto doskip1
   if resn1 .eq. POPI2A goto doskip1
   if resn1 .eq. POPI2B goto doskip1
   if resn1 .eq. POPI2C goto doskip1
   if resn1 .eq. POPI2D goto doskip1
   if resn1 .eq. POPI33 goto doskip1
   if resn1 .eq. POPI34 goto doskip1
   if resn1 .eq. POPI35 goto doskip1
   if resn1 .eq. PLPI   goto doskip1
   if resn1 .eq. PLPI13 goto doskip1
   if resn1 .eq. PLPI14 goto doskip1
   if resn1 .eq. PLPI15 goto doskip1
   if resn1 .eq. PLPI24 goto doskip1
   if resn1 .eq. PLPI25 goto doskip1
   if resn1 .eq. PLPI2A goto doskip1
   if resn1 .eq. PLPI2B goto doskip1
   if resn1 .eq. PLPI2C goto doskip1
   if resn1 .eq. PLPI2D goto doskip1
   if resn1 .eq. PLPI33 goto doskip1
   if resn1 .eq. PLPI34 goto doskip1
   if resn1 .eq. PLPI35 goto doskip1
   if resn1 .eq. PNPI   goto doskip1
   if resn1 .eq. PNPI13 goto doskip1
   if resn1 .eq. PNPI14 goto doskip1
   if resn1 .eq. PNPI15 goto doskip1
   if resn1 .eq. PNPI24 goto doskip1
   if resn1 .eq. PNPI25 goto doskip1
   if resn1 .eq. PNPI2A goto doskip1
   if resn1 .eq. PNPI2B goto doskip1
   if resn1 .eq. PNPI2C goto doskip1
   if resn1 .eq. PNPI2D goto doskip1
   if resn1 .eq. PNPI33 goto doskip1
   if resn1 .eq. PNPI34 goto doskip1
   if resn1 .eq. PNPI35 goto doskip1
   if resn1 .eq. SLPI   goto doskip1
   if resn1 .eq. SAPI   goto doskip1
   if resn1 .eq. SAPI13 goto doskip1
   if resn1 .eq. SAPI14 goto doskip1
   if resn1 .eq. SAPI15 goto doskip1
   if resn1 .eq. SAPI24 goto doskip1
   if resn1 .eq. SAPI25 goto doskip1
   if resn1 .eq. SAPI2A goto doskip1
   if resn1 .eq. SAPI2B goto doskip1
   if resn1 .eq. SAPI2C goto doskip1
   if resn1 .eq. SAPI2D goto doskip1
   if resn1 .eq. SAPI33 goto doskip1
   if resn1 .eq. SAPI34 goto doskip1
   if resn1 .eq. SAPI35 goto doskip1
   if resn1 .eq. SDPI   goto doskip1
   if resn1 .eq. DLIPI  goto doskip1
   if resn1 .eq. LINPI  goto doskip1
   set x1 = ?xave
   set y1 = ?yave
   set z1 = ?zave

   define target sele segid head .and. resid @LipidNum:@nliptop .and. prop Z .gt. 0 end
   coor mindist sele target end sele PROT .and. .not. hydrogen end
   coor stat sele bynum ?MINDA1 end
   set resid2 = ?selresi
   set resn2 = ?selresn
   set x2 = ?xave
   set y2 = ?yave
   set z2 = ?zave

   coor set xdir @x2 ydir @y2 zdir @z2 sele segid head .and. resid @LipidNum end
   rename resname @resn2 sele segid head .and. resid @LipidNum end

   coor set xdir @x1 ydir @y1 zdir @z1 sele segid head .and. resid @resid2 end
   rename resname @resn1 sele segid head .and. resid @resid2 end

   label doskip1

   coor mindist sele segid head .and. resid @LipidNum end sele PROT .and. .not. hydrogen end
   scalar wmain set ?mind sele segid head .and. resid @LipidNum end

increase LipidNum by 1
if LipidNum .le. @nliptop goto dosort1

! Bottom leaflet
!
label dosort2

   coor stat sele segid head .and. resid @LipidNum end
   set resn1 = ?selresn
   if resn1 .eq. CHL1   goto	doskip2
   if resn1 .eq. ERG    goto	doskip2
   if resn1 .eq. SITO   goto	doskip2
   if resn1 .eq. STIG   goto	doskip2
   if resn1 .eq. CHSD   goto	doskip2
   if resn1 .eq. CHSP   goto	doskip2
   if resn1 .eq. CAMP   goto	doskip2
   if resn1 .eq. GCAMP  goto	doskip2
   if resn1 .eq. GSITO  goto	doskip2
   if resn1 .eq. GSTIG  goto	doskip2
   if resn1 .eq. LANO   goto	doskip2
   if resn1 .eq. PGCAMP goto	doskip2
   if resn1 .eq. PGSITO goto	doskip2
   if resn1 .eq. PGSTIG goto	doskip2
   if resn1 .eq. DMPI   goto	doskip2
   if resn1 .eq. DMPI13 goto	doskip2
   if resn1 .eq. DMPI14 goto	doskip2
   if resn1 .eq. DMPI15 goto	doskip2
   if resn1 .eq. DMPI24 goto	doskip2
   if resn1 .eq. DMPI25 goto	doskip2
   if resn1 .eq. DMPI2A goto	doskip2
   if resn1 .eq. DMPI2B goto	doskip2
   if resn1 .eq. DMPI2C goto	doskip2
   if resn1 .eq. DMPI2D goto	doskip2
   if resn1 .eq. DMPI33 goto	doskip2
   if resn1 .eq. DMPI34 goto	doskip2
   if resn1 .eq. DMPI35 goto	doskip2
   if resn1 .eq. DPPI   goto	doskip2
   if resn1 .eq. PYPI   goto	doskip2
   if resn1 .eq. PSPI   goto	doskip2
   if resn1 .eq. POPI   goto	doskip2
   if resn1 .eq. POPI13 goto	doskip2
   if resn1 .eq. POPI14 goto	doskip2
   if resn1 .eq. POPI15 goto	doskip2
   if resn1 .eq. POPI24 goto	doskip2
   if resn1 .eq. POPI25 goto	doskip2
   if resn1 .eq. POPI2A goto	doskip2
   if resn1 .eq. POPI2B goto	doskip2
   if resn1 .eq. POPI2C goto	doskip2
   if resn1 .eq. POPI2D goto	doskip2
   if resn1 .eq. POPI33 goto	doskip2
   if resn1 .eq. POPI34 goto	doskip2
   if resn1 .eq. POPI35 goto	doskip2
   if resn1 .eq. PLPI   goto	doskip2
   if resn1 .eq. PLPI13 goto	doskip2
   if resn1 .eq. PLPI14 goto	doskip2
   if resn1 .eq. PLPI15 goto	doskip2
   if resn1 .eq. PLPI24 goto	doskip2
   if resn1 .eq. PLPI25 goto	doskip2
   if resn1 .eq. PLPI2A goto	doskip2
   if resn1 .eq. PLPI2B goto	doskip2
   if resn1 .eq. PLPI2C goto	doskip2
   if resn1 .eq. PLPI2D goto	doskip2
   if resn1 .eq. PLPI33 goto	doskip2
   if resn1 .eq. PLPI34 goto	doskip2
   if resn1 .eq. PLPI35 goto	doskip2
   if resn1 .eq. PNPI   goto	doskip2
   if resn1 .eq. PNPI13 goto	doskip2
   if resn1 .eq. PNPI14 goto	doskip2
   if resn1 .eq. PNPI15 goto	doskip2
   if resn1 .eq. PNPI24 goto	doskip2
   if resn1 .eq. PNPI25 goto	doskip2
   if resn1 .eq. PNPI2A goto	doskip2
   if resn1 .eq. PNPI2B goto	doskip2
   if resn1 .eq. PNPI2C goto	doskip2
   if resn1 .eq. PNPI2D goto	doskip2
   if resn1 .eq. PNPI33 goto	doskip2
   if resn1 .eq. PNPI34 goto	doskip2
   if resn1 .eq. PNPI35 goto	doskip2
   if resn1 .eq. SLPI   goto	doskip2
   if resn1 .eq. SAPI   goto	doskip2
   if resn1 .eq. SAPI13 goto	doskip2
   if resn1 .eq. SAPI14 goto	doskip2
   if resn1 .eq. SAPI15 goto	doskip2
   if resn1 .eq. SAPI24 goto	doskip2
   if resn1 .eq. SAPI25 goto	doskip2
   if resn1 .eq. SAPI2A goto	doskip2
   if resn1 .eq. SAPI2B goto	doskip2
   if resn1 .eq. SAPI2C goto	doskip2
   if resn1 .eq. SAPI2D goto	doskip2
   if resn1 .eq. SAPI33 goto	doskip2
   if resn1 .eq. SAPI34 goto	doskip2
   if resn1 .eq. SAPI35 goto	doskip2
   if resn1 .eq. SDPI   goto	doskip2
   if resn1 .eq. DLIPI  goto	doskip2
   if resn1 .eq. LINPI  goto	doskip2
   set x1 = ?xave
   set y1 = ?yave
   set z1 = ?zave

   define target sele segid head .and. resid @LipidNum:@Nlipid end
   coor mindist sele target end sele PROT .and. .not. hydrogen end
   coor stat sele bynum ?MINDA1 end
   set resid2 = ?selresi
   set resn2 = ?selresn
   set x2 = ?xave
   set y2 = ?yave
   set z2 = ?zave

   coor set xdir @x2 ydir @y2 zdir @z2 sele segid head .and. resid @LipidNum end
   rename resname @resn2 sele segid head .and. resid @LipidNum end

   coor set xdir @x1 ydir @y1 zdir @z1 sele segid head .and. resid @resid2 end
   rename resname @resn1 sele segid head .and. resid @resid2 end

   label doskip2

   coor mindist sele segid head .and. resid @LipidNum end sele PROT .and. .not. hydrogen end
   scalar wmain set ?mind sele segid head .and. resid @LipidNum end

increase LipidNum by 1
if LipidNum .le. @Nlipid goto dosort2

scalar wmain show sele segid head end   ! wamin = minimum distance from the protein

!==============================================================================
! Randomly choosing the lipids and hydration water

!Random number generation for picking lipids
RAND UNIF ISEED 1603440019

set LipidNum = 1
set hasring = no

label loop_gen

   set cntrand = 0

   coor stat sele segid HEAD .and. resid @LipidNum end
   set lipid = ?selresn

   set issterol = no
   if lipid .eq. CHL1 then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. ERG then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. SITO then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. STIG then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. CHSD then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 .or. type C4' .or. type O2' .or. type C5' )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. CHSP then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 .or. type C4' .or. type O2' .or. type C5' )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. CAMP then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. GCAMP then
      calc zpostop = 18
      set HG ( type C3 .or. type 2O1 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. GSITO then
      calc zpostop = 18
      set HG ( type C3 .or. type 2O1 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. GSTIG then
      calc zpostop = 18
      set HG ( type C3 .or. type 2O1 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. LANO then
      calc zpostop = 18
      set HG ( type C3 .or. type O3 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. PGCAMP then
      calc zpostop = 18
      set HG ( type C3 .or. type 2O1 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. PGSITO then
      calc zpostop = 18
      set HG ( type C3 .or. type 2O1 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. PGSTIG then
      calc zpostop = 18
      set HG ( type C3 .or. type 2O1 )
      set issterol = yes
      goto repeatrand
   endif
   if lipid .eq. DLPA then
      calc zpostop = 15
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DMPA then
      calc zpostop = 17
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DPPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PSPA then
      calc zpostop = 21.0
      set HG ( type P .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DSPA then
      calc zpostop = 21
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. POPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SOPA then
      calc zpostop = 21
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SLPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DYPA then
      calc zpostop = 17
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. YOPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DOPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DGPA then
      calc zpostop = 21
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DEPA then
      calc zpostop = 23
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DNPA then
      calc zpostop = 25
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DDPC then
      calc zpostop = 13
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DCPC then
      calc zpostop = 14
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DLPC then
      calc zpostop = 15
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DMPC then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DPPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DSPC then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. POPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLPC then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PDOPC then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SOPC then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SLPC then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DRPC then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DYPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. YOPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DOPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DUPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DGPC then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DEPC then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DDOPC then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DNPC then
      calc zpostop = 25
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DLIPC then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. LLPC then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DLPE then
      calc zpostop = 15
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DMPE then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DPPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PSPE then
      calc zpostop = 21.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DSPE then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PYPE then
      calc zpostop = 21.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. POPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLPE then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PDOPE then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SOPE then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SLPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DYPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. YOPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. OYPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DOPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DGPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DEPE then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DDOPE then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DNPE then
      calc zpostop = 25
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DLIPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. LLPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DLPG then
      calc zpostop = 15
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DMPG then
      calc zpostop = 17
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DPPG then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PSPG then
      calc zpostop = 21.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DSPG then
      calc zpostop = 21
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PYPG then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. POPG then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PLPG then
      calc zpostop = 17
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. SOPG then
      calc zpostop = 21
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. SLPG then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DYPG then
      calc zpostop = 17
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DOPG then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DGPG then
      calc zpostop = 21
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DEPG then
      calc zpostop = 23
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DNPG then
      calc zpostop = 25
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DLPS then
      calc zpostop = 15
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DMPS then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DPPS then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. PSPS then
      calc zpostop = 21.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DSPS then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. POPS then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. PSPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PAPC then
      calc zpostop = 20
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLPS then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. SOPS then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. SLPS then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. OLPS then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DYPS then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. YOPS then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DOPS then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DGPS then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DEPS then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DDOPS then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DNPS then
      calc zpostop = 25
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. LLPS then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. POPP1 then
      calc zpostop = 19
      set HG ( type P+ .or. type C1 .or. type O1+','OP2+ )
      goto repeatrand
   endif
   if lipid .eq. POPP2 then
      calc zpostop = 19
      set HG ( type P+ .or. type C1 .or. type O1+','OP2+ )
      goto repeatrand
   endif
   if lipid .eq. POPP3 then
      calc zpostop = 19
      set HG ( type P+ .or. type C1 .or. type O1+','OP2+ )
      goto repeatrand
   endif
   if lipid .eq. DOPP1 then
      calc zpostop = 19
      set HG ( type P+ .or. type C1 .or. type O1+','OP2+ )
      goto repeatrand
   endif
   if lipid .eq. DOPP2 then
      calc zpostop = 19
      set HG ( type P+ .or. type C1 .or. type O1+','OP2+ )
      goto repeatrand
   endif
   if lipid .eq. DOPP3 then
      calc zpostop = 19
      set HG ( type P+ .or. type C1 .or. type O1+','OP2+ )
      goto repeatrand
   endif
   if lipid .eq. DMPI then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI13 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI14 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI15 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI24 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI25 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI2A then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI2B then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI2C then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI2D then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI33 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI34 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DMPI35 then
      calc zpostop = 17
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DPPI then
      calc zpostop = 19.0
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PYPI then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PSPI then
      calc zpostop = 21.0
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI13 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI14 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI15 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI24 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI25 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI2A then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI2B then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI2C then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI2D then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI33 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI34 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. POPI35 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI13 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI14 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI15 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI24 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI25 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI2A then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI2B then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI2C then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI2D then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI33 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI34 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PLPI35 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI13 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI14 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI15 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI24 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI25 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI2A then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI2B then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI2C then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI2D then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI33 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI34 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. PNPI35 then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SLPI then
      calc zpostop = 21.0
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI13 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI14 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI15 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI24 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI25 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI2A then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI2B then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI2C then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI2D then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI33 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI34 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SAPI35 then
      calc zpostop = 20
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. SDPI then
      calc zpostop = 20.0
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. DLIPI then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. LINPI then
      calc zpostop = 19
      set HG ( type P .or. type O1+ .or. type C1 .or. type C2 .or. type C3 )
      goto repeatrand
   endif
   if lipid .eq. TMCL1 then
      calc zpostop = 17
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. TMCL2 then
      calc zpostop = 17
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. PMCL1 then
      calc zpostop = 17
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. PMCL2 then
      calc zpostop = 17
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. PAICL2 then
      calc zpostop = 17.0
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. PVCL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. TYCL1 then
      calc zpostop = 17
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. TYCL2 then
      calc zpostop = 17
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. TOCL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. TOCL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LOACL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LOACL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LOCCL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LOCCL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. TLCL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. TLCL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNCCL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNCCL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNACL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNACL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNDCL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNDCL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNBCL1 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LNBCL2 then
      calc zpostop = 19
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. DLGL then
      calc zpostop = 15
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DMGL then
      calc zpostop = 17
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DPGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DSGL then
      calc zpostop = 21
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. POGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. PLGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. SOGL then
      calc zpostop = 21
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. SLGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. SAGL then
      calc zpostop = 20
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. SDGL then
      calc zpostop = 20.5
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DYGL then
      calc zpostop = 17
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DOGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DGGL then
      calc zpostop = 21
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DEGL then
      calc zpostop = 23
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DNGL then
      calc zpostop = 25
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DTGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. TIGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DIGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. LLGL then
      calc zpostop = 19
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. DAGL then
      calc zpostop = 18
      set HG ( type O11 .or. type C1 )
      goto repeatrand
   endif
   if lipid .eq. SAPA then
      calc zpostop = 20
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SAPC then
      calc zpostop = 20
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SAPE then
      calc zpostop = 20
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SAPG then
      calc zpostop = 20
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. SAPS then
      calc zpostop = 20
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. SDPA then
      calc zpostop = 20.5
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SDPC then
      calc zpostop = 20.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SDPE then
      calc zpostop = 20.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SDPG then
      calc zpostop = 20.5
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. SDPS then
      calc zpostop = 20.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. DAPA then
      calc zpostop = 18
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DAPC then
      calc zpostop = 18
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DAPE then
      calc zpostop = 18
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DAPG then
      calc zpostop = 18
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DAPS then
      calc zpostop = 18
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. PEPS then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. OEPS then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. TSPC then
      calc zpostop = 20.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DTPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. TIPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DIPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. LLPA then
      calc zpostop = 19
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. LLPG then
      calc zpostop = 19.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PLEPC then
      calc zpostop = 19.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLEPE then
      calc zpostop = 19.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLEPS then
      calc zpostop = 19.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type OC+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. PLEPA then
      calc zpostop = 19.0
      set HG ( type P .or. type C1 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLEPG then
      calc zpostop = 19.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PAPE then
      calc zpostop = 19.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PAPS then
      calc zpostop = 19.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ .or. type O13% )
      goto repeatrand
   endif
   if lipid .eq. PAPG then
      calc zpostop = 19.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PAPA then
      calc zpostop = 19.0
      set HG ( type P .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. LYPG then
      calc zpostop = 19.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. DSM then
      calc zpostop = 25.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. TSM then
      calc zpostop = 25.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PSM then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. SSM then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. ASM then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. BSM then
      calc zpostop = 25
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. 23SM then
      calc zpostop = 26
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. LSM then
      calc zpostop = 27
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. OSM then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. NSM then
      calc zpostop = 27
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. CER160 then
      calc zpostop = 19
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER180 then
      calc zpostop = 19
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER181 then
      calc zpostop = 19
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER200 then
      calc zpostop = 22
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER220 then
      calc zpostop = 22
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER240 then
      calc zpostop = 24
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER241 then
      calc zpostop = 24
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER3E then
      calc zpostop = 19
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER6 then
      calc zpostop = 24
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER3 then
      calc zpostop = 24
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. CER1 then
      calc zpostop = 24
      set HG ( type O1 .or. type C1S .or. type C2S .or. type C3S .or. type NF .or. type O3 )
      goto repeatrand
   endif
   if lipid .eq. MAIPC then
      calc zpostop = 17.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. MAIPG then
      calc zpostop = 17.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. MAIPE then
      calc zpostop = 17.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. AIPC then
      calc zpostop = 17.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. AIPG then
      calc zpostop = 17.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. AIPE then
      calc zpostop = 17.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. QMPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. PAIPC then
      calc zpostop = 19.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PAIPG then
      calc zpostop = 19.0
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PAIPE then
      calc zpostop = 19.0
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. APPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. IPPC then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PMPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. PMPG then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PHPC then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PPPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PVPE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PVPG then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PEPC then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PEPE then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. OEPE then
      calc zpostop = 21
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. OEPC then
      calc zpostop = 23
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DPPGK then
      calc zpostop = 19
      set HG ( type P .or. type C1+ .or. type O1+ .or. type OC+ )
      goto repeatrand
   endif
   if lipid .eq. PGMAR then
      calc zpostop = 18
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. AROL then
      calc zpostop = 15
      set HG ( type C2 )
      goto repeatrand
   endif
   if lipid .eq. PGAR then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PEAR then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. MEN7 then
      calc zpostop = 17
      set HG ( type OR5 .or. type OR8 )
      goto repeatrand
   endif
   if lipid .eq. MEN8 then
      calc zpostop = 17
      set HG ( type OR5 .or. type OR8 )
      goto repeatrand
   endif
   if lipid .eq. MEN9 then
      calc zpostop = 17
      set HG ( type OR5 .or. type OR8 )
      goto repeatrand
   endif
   if lipid .eq. MKOL8 then
      calc zpostop = 17
      set HG ( type OR5 .or. type OR8 )
      goto repeatrand
   endif
   if lipid .eq. ARCL2 then
      calc zpostop = 18
      set HG ( type P+ .or. type OP++ .or. type C1+ .or. type C2 .or. type C3+ )
      goto repeatrand
   endif
   if lipid .eq. LAU then
      calc zpostop = 12
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. MYR then
      calc zpostop = 14
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. PAL then
      calc zpostop = 16
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. STE then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ARA then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. BEH then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TRI then
      calc zpostop = 23
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. LIGN then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. MYRO then
      calc zpostop = 14
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. PALO then
      calc zpostop = 16
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. HTA then
      calc zpostop = 16
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. OLE then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. LIN then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ALIN then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. SDA then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. GLA then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. EICO then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. EDA then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. MEA then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DGLA then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ETE then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ETA then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. EPA then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ARAN then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. HPA then
      calc zpostop = 21
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ERU then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DDA then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ADR then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DPT then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DPA then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DHA then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. NER then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TTA then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TPT then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TPA then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. THA then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. LAUP then
      calc zpostop = 12
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. MYRP then
      calc zpostop = 14
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. PALP then
      calc zpostop = 16
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. STEP then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ARAP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. BEHP then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TRIP then
      calc zpostop = 23
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. LIGNP then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. MYROP then
      calc zpostop = 14
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. PALOP then
      calc zpostop = 16
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. HTAP then
      calc zpostop = 16
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. OLEP then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. LINP then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ALINP then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. SDAP then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. GLAP then
      calc zpostop = 18
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. EICOP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. EDAP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. MEAP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DGLAP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ETEP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ETAP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. EPAP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ARANP then
      calc zpostop = 20
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. HPAP then
      calc zpostop = 21
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ERUP then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DDAP then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. ADRP then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DPTP then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DPAP then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. DHAP then
      calc zpostop = 22
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. NERP then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TTAP then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TPTP then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. TPAP then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. THAP then
      calc zpostop = 24
      set HG ( type O1 .or. type O2 )
      goto repeatrand
   endif
   if lipid .eq. SB3-10 then
      calc zpostop = 13.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. SB3-12 then
      calc zpostop = 15.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. SB3-14 then
      calc zpostop = 17.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. CHAPS then
      calc zpostop = 14.0
      set HG ( type N )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. CHAPSO then
      calc zpostop = 14.0
      set HG ( type N )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. DDMG then
      calc zpostop = 13.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. DOMG then
      calc zpostop = 15.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. DDAO then
      calc zpostop = 13.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. UDAO then
      calc zpostop = 14.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. LDAO then
      calc zpostop = 15.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. LAPAO then
      calc zpostop = 15.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. TRIPAO then
      calc zpostop = 10.0
      set HG ( type N )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. FOS10 then
      calc zpostop = 13.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. FOS12 then
      calc zpostop = 15.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. FOS13 then
      calc zpostop = 16.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. FOS14 then
      calc zpostop = 17.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. FOS15 then
      calc zpostop = 18.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. FOS16 then
      calc zpostop = 19.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. UFOS10 then
      calc zpostop = 14.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. LPC12 then
      calc zpostop = 15.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. LPC14 then
      calc zpostop = 17.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. LPC16 then
      calc zpostop = 19.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. FOIS9 then
      calc zpostop = 8.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. FOIS11 then
      calc zpostop = 9.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. C6DHPC then
      calc zpostop = 14.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. C7DHPC then
      calc zpostop = 15.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. CYFOS3 then
      calc zpostop = 10.0
      set HG ( type P )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. CYFOS4 then
      calc zpostop = 10.0
      set HG ( type P )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. CYFOS5 then
      calc zpostop = 10.0
      set HG ( type P )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. CYFOS6 then
      calc zpostop = 11.0
      set HG ( type P )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. CYFOS7 then
      calc zpostop = 12.0
      set HG ( type P )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. SDS then
      calc zpostop = 15.0
      set HG ( type S )
      goto repeatrand
   endif
   if lipid .eq. LMPG then
      calc zpostop = 17.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. LPPG then
      calc zpostop = 17.0
      set HG ( type P )
      goto repeatrand
   endif
   if lipid .eq. DDAOP then
      calc zpostop = 13.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. UDAOP then
      calc zpostop = 14.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. LDAOP then
      calc zpostop = 15.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. LAPAOP then
      calc zpostop = 15.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. TRPAOP then
      calc zpostop = 10.0
      set HG ( type N )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. C6EG3 then
      calc zpostop = 10.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C6EG4 then
      calc zpostop = 10.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C6EG5 then
      calc zpostop = 10.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C7EG4 then
      calc zpostop = 11.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C7EG5 then
      calc zpostop = 11.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C8EG4 then
      calc zpostop = 12.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C8EG5 then
      calc zpostop = 12.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C8EG6 then
      calc zpostop = 12.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C10EG5 then
      calc zpostop = 14.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C10EG6 then
      calc zpostop = 14.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C10EG9 then
      calc zpostop = 14.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C12EG7 then
      calc zpostop = 17.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C12EG8 then
      calc zpostop = 20.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C12EG9 then
      calc zpostop = 20.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C12DEG then
      calc zpostop = 20.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. C13EG8 then
      calc zpostop = 18.0
      set HG ( type 1O1 )
      goto repeatrand
   endif
   if lipid .eq. NIDP40 then
      calc zpostop = 10.0
      set HG ( type 1O1 )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. TX100 then
      calc zpostop = 10.0
      set HG ( type 1O1 )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. TX114 then
      calc zpostop = 10.0
      set HG ( type 1O1 )
      set hasring = yes
      goto repeatrand
   endif
   if lipid .eq. AOG then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BOG then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ANG then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BNG then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ADG then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDG then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ADDG then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDDG then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ACY3G then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BCY3G then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. AMHCG then
      calc zpostop = 10.0
      set HG ( type N1 )
      goto repeatrand
   endif
   if lipid .eq. BMHCG then
      calc zpostop = 10.0
      set HG ( type N1 )
      goto repeatrand
   endif
   if lipid .eq. AOM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BOM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ANM then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BNM then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ADM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. AUDM then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BUDM then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. A2UDM then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. B2UDM then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ADDM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDDM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ADMHM then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDMHM then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. APPM then
      calc zpostop = 7.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BPPM then
      calc zpostop = 7.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ATM then
      calc zpostop = 16.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BTM then
      calc zpostop = 16.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ACY3M then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BCY3M then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ACY4M then
      calc zpostop = 11.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BCY4M then
      calc zpostop = 11.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ACY5M then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BCY5M then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ACY6M then
      calc zpostop = 13.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BCY6M then
      calc zpostop = 13.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ACY7M then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BCY7M then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. NHEG then
      calc zpostop = 11.0
      set HG ( type NF )
      goto repeatrand
   endif
   if lipid .eq. DHEG then
      calc zpostop = 12.0
      set HG ( type NF )
      goto repeatrand
   endif
   if lipid .eq. NMG then
      calc zpostop = 11.0
      set HG ( type NF )
      goto repeatrand
   endif
   if lipid .eq. DMG then
      calc zpostop = 12.0
      set HG ( type NF )
      goto repeatrand
   endif
   if lipid .eq. CTB10 then
      calc zpostop = 13.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. CTB11 then
      calc zpostop = 14.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. CTB12 then
      calc zpostop = 15.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. CTB13 then
      calc zpostop = 16
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. CTB14 then
      calc zpostop = 17.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. CTB15 then
      calc zpostop = 18.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. CTB16 then
      calc zpostop = 19.0
      set HG ( type N )
      goto repeatrand
   endif
   if lipid .eq. GMS1 then
      calc zpostop = 21.0
      set HG ( type C2 )
      goto repeatrand
   endif
   if lipid .eq. GMS2 then
      calc zpostop = 21.0
      set HG ( type C2 )
      goto repeatrand
   endif
   if lipid .eq. MLN1 then
      calc zpostop = 19.0
      set HG ( type C2 )
      goto repeatrand
   endif
   if lipid .eq. MLN2 then
      calc zpostop = 19.0
      set HG ( type C2 )
      goto repeatrand
   endif
   if lipid .eq. MGTM10 then
      calc zpostop = 30.0
      set HG ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 )
      goto repeatrand
   endif
   if lipid .eq. MGTM11 then
      calc zpostop = 31.0
      set HG ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 )
      goto repeatrand
   endif
   if lipid .eq. EGTM10 then
      calc zpostop = 30.0
      set HG ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 )
      goto repeatrand
   endif
   if lipid .eq. EGTM11 then
      calc zpostop = 31.0
      set HG ( type CC1 .or. type 3C2 .or. type 6C2 .or. type 9C2 )
      goto repeatrand
   endif
   if lipid .eq. SMDD then
      calc zpostop = 15.0
      set HG ( type 2C5 )
      goto repeatrand
   endif
   if lipid .eq. BBPHG then
      calc zpostop = 12.0
      set HG ( type 5C1 )
      goto repeatrand
   endif
   if lipid .eq. BBCYG then
      calc zpostop = 12.0
      set HG ( type 5C1 )
      goto repeatrand
   endif
   if lipid .eq. BOGNG then
      calc zpostop = 16.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BLMNG then
      calc zpostop = 20.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDMNG then
      calc zpostop = 18.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. C5MNG then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. C6MNG then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BOTGNG then
      calc zpostop = 12.0
      set HG ( type 2C* )
      goto repeatrand
   endif
   if lipid .eq. BOING then
      calc zpostop = 12.0
      set HG ( type 2C* )
      goto repeatrand
   endif
   if lipid .eq. AHTG then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BHTG then
      calc zpostop = 10.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. AOTG then
      calc zpostop = 11.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BOTG then
      calc zpostop = 11.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. AOTM then
      calc zpostop = 11.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BOTM then
      calc zpostop = 11.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ANTM then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BNTM then
      calc zpostop = 12.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ADTM then
      calc zpostop = 13.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDTM then
      calc zpostop = 13.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. AUDTM then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BUDTM then
      calc zpostop = 14.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. ADDTM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. BDDTM then
      calc zpostop = 15.0
      set HG ( type 2C1 )
      goto repeatrand
   endif
   if lipid .eq. DHPCE then
      calc zpostop = 16
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. POPCE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DOPCE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DMPCE then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. POPEE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DOPEE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DPPEE then
      calc zpostop = 19
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DMPEE then
      calc zpostop = 17
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. BMGP then
      calc zpostop = 20
      set HG ( type P .or. type C1 .or. type C11 .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. DMTAP then
      calc zpostop = 17
      set HG ( type N .or. type C1+ )
      goto repeatrand
   endif
   if lipid .eq. DPTAP then
      calc zpostop = 19
      set HG ( type N .or. type C1+ )
      goto repeatrand
   endif
   if lipid .eq. DOTAP then
      calc zpostop = 21
      set HG ( type N .or. type C1+ )
      goto repeatrand
   endif
   if lipid .eq. DSTAP then
      calc zpostop = 21
      set HG ( type N .or. type C1+ )
      goto repeatrand
   endif
   if lipid .eq. PLA20 then
      calc zpostop = 19.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLA18 then
      calc zpostop = 19.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLC22 then
      calc zpostop = 19.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLC20 then
      calc zpostop = 19.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif
   if lipid .eq. PLC18 then
      calc zpostop = 19.5
      set HG ( type P .or. type N .or. type C1+ .or. type O1+ )
      goto repeatrand
   endif

   stop ! the lipid type is not defined
   !prnlev 5

   label repeatrand

      calc cntrand = @cntrand + 1
      if cntrand .gt. 100 stop ! replacement may not work.. stop here

      set randn ?RAND
      if randn .le. 0.5 set Lipdir conf1   ! conf1 and conf2 are two directories
      if randn .gt. 0.5 set Lipdir conf2   ! containing lipid structures
      set randn ?RAND
      if randn .ge. 1.0 goto repeatrand
      calc N = int( @randn * 1000 ) + 1

      open read card unit 1 name lipid_lib/@lipid/@Lipdir/@lipid_@N.crd
      read sequence coor unit 1
      generate L@LipidNum setup noangle nodihedrals first none last none
      close unit 1

      open read card unit 1 name lipid_lib/@lipid/@Lipdir/@lipid_@N.crd
      read coor card unit 1 append
      close unit 1

      coor print sele ( .not. INIT ) end
      ic param
      ic build
      prnlev 0
      hbuild
      prnlev 5
      coor print sele ( .not. INIT ) end
      if ?nsel .gt. 0 stop

      label nextstep

      ! put the X-Y center of mass of the lipid head at the origin
      coor stat sele segid L@LipidNum .and. @HG end
      coor trans xdir -?XAVE ydir -?YAVE zdir -?ZAVE select segid L@LipidNum end

      ! randomly rotate along Z
      calc rotang = 360.0 * ?rand
      coor rotate zdir 1.0 phi @rotang select segid L@LipidNum end

      ! flip the orientation of the lipids in the lower monolayer if head Z le 0
      coor stat sele segid HEAD .and. resid @LipidNum end
      if ?ZMIN le 0  coor rotate xdir 1.0  phi 180.0 select segid L@LipidNum end

      ! put the head group at the location of the spheres
      coor stat sele segid HEAD .and. resid @LipidNum end
      if ?ZMIN gt 0.0 coor trans xdir ?XMIN ydir ?YMIN zdir  @ZPosTOP select segid L@LipidNum end
      if ?ZMIN le 0.0 coor trans xdir ?XMIN ydir ?YMIN zdir -@ZPosTOP select segid L@LipidNum end

      set xhead = ?xave
      set yhead = ?yave
      set zhead = ?zave
      set rhead = ?wave

      set nbad = 5
      ! increase the lipid bad contact limit for cardiolipin
      if lipid .eq. TMCL1  set nbad = 10
      if lipid .eq. TMCL2  set nbad = 10
      if lipid .eq. PMCL1  set nbad = 10
      if lipid .eq. PMCL2  set nbad = 10
      if lipid .eq. PAICL2 set nbad = 10
      if lipid .eq. PVCL2  set nbad = 10
      if lipid .eq. TYCL1  set nbad = 10
      if lipid .eq. TYCL2  set nbad = 10
      if lipid .eq. TOCL1  set nbad = 10
      if lipid .eq. TOCL2  set nbad = 10
      if lipid .eq. LOACL1 set nbad = 10
      if lipid .eq. LOACL2 set nbad = 10
      if lipid .eq. LOCCL1 set nbad = 10
      if lipid .eq. LOCCL2 set nbad = 10
      if lipid .eq. TLCL1  set nbad = 10
      if lipid .eq. TLCL2  set nbad = 10
      if lipid .eq. LNCCL1 set nbad = 10
      if lipid .eq. LNCCL2 set nbad = 10
      if lipid .eq. LNACL1 set nbad = 10
      if lipid .eq. LNACL2 set nbad = 10
      if lipid .eq. LNDCL1 set nbad = 10
      if lipid .eq. LNDCL2 set nbad = 10
      if lipid .eq. LNBCL1 set nbad = 10
      if lipid .eq. LNBCL2 set nbad = 10
      if lipid .eq. ARCL2  set nbad = 10

      !
      ! check whether the lipid penetrates the protein (or cholesterol)
      !

      calc delang    = 35.0   ! rotation increment
      calc delxy     =  1.0   ! xy translation increment

      define target sele segid L@LipidNum end

      coor stat sele target end
      calc dcut = 5.0
      calc xmax = ?xmax + @dcut
      calc ymax = ?ymax + @dcut
      calc zmax = ?zmax + @dcut
      calc xmin = ?xmin - @dcut
      calc ymin = ?ymin - @dcut
      calc zmin = ?zmin - @dcut

      calc XYhalf = @A / 2

      define prxp sele ( prop X .ge. @XYhalf ) .and. .not. target end
      set nprxp = ?nsel
      if nprxp .gt. 0 coor trans xdir -@A sele prxp end
      define pryp sele ( prop Y .ge. @XYhalf ) .and. .not. target end
      set npryp = ?nsel
      if npryp .gt. 0 coor trans ydir -@A sele pryp end
      define prxn sele ( prop X .le. -@XYhalf ) .and. .not. target end
      set nprxn = ?nsel
      if nprxn .gt. 0 coor trans xdir @A sele prxn end
      define pryn sele ( prop Y .le. -@XYhalf ) .and. .not. target end
      set npryn = ?nsel
      if npryn .gt. 0 coor trans ydir @A sele pryn end

      define imxp sele none end
      define imyp sele none end
      define imxn sele none end
      define imyn sele none end

      set nimxp = 0
      set nimyp = 0
      set nimxn = 0
      set nimyn = 0

      if xmax .gt. @XYhalf then
         calc xdiff = -@A + @xmax
         define imxp sele prop X .le. @xdiff end
         set nimxp = ?nsel
         if nimxp .gt. 0 coor trans xdir @A sele imxp end
      endif
      if ymax .gt. @XYhalf then
         calc ydiff = -@A + @ymax
         define imyp sele prop Y .le. @ydiff end
         set nimyp = ?nsel
         if nimyp .gt. 0 coor trans ydir @A sele imyp end
      endif
      if xmin .lt. -@XYhalf then
         calc xdiff = @A + @xmin
         define imxn sele prop X .ge. @xdiff end
         set nimxn = ?nsel
         if nimxn .gt. 0 coor trans xdir -@A sele imxn end
      endif
      if ymin .lt. -@XYhalf then
         calc ydiff = @A + @ymin
         define imyn sele prop Y .ge. @ydiff end
         set nimyn = ?nsel
         if nimyn .gt. 0 coor trans ydir -@A sele imyn end
      endif

      define JUNK sele .not. target .and. .not. hydrogen .and. -
                       prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
                       prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
                       prop Z .lt. @zmax .and. prop Z .gt. @zmin  end

      calc xmove = 0.0
      calc ymove = 0.0
      calc nxymove = 1

      label doxymove

         if nxymove .eq. 2 incr xmove by 1
         if nxymove .eq. 3 incr ymove by 1
         if nxymove .eq. 4 decr xmove by 1
         if nxymove .eq. 5 decr xmove by 1
         if nxymove .eq. 6 decr ymove by 1
         if nxymove .eq. 7 decr ymove by 1
         if nxymove .eq. 8 incr xmove by 1
         if nxymove .eq. 9 incr xmove by 1

         !protein-head distance check for close ones
         !
         if rhead .le. 7.0 then
            coor trans xdir @xmove ydir @ymove sele target end
            coor stat sele target .and. @HG end
            coor set xdir ?xave ydir ?yave zdir ?zave sele segid dum end
            coor mindist sele segid dum end sele PROT .and. .not. hydrogen end
            if nxymove .eq. 1 set mind1 = ?mind
            if nxymove .eq. 9 then
               if ?mind .lt. @mind1 then
                  if nimyn .gt. 0 coor trans ydir @A sele imyn end
                  if nimxn .gt. 0 coor trans xdir @A sele imxn end
                  if nimyp .gt. 0 coor trans ydir -@A sele imyp end
                  if nimxp .gt. 0 coor trans xdir -@A sele imxp end

                  if npryn .gt. 0 coor trans ydir -@A sele pryn end
                  if nprxn .gt. 0 coor trans xdir -@A sele prxn end
                  if npryp .gt. 0 coor trans ydir @A sele pryp end
                  if nprxp .gt. 0 coor trans xdir @A sele prxp end

                  delete atoms sele segid L@LipidNum end
                  goto repeatrand
               endif
            endif
            if ?mind .lt. @mind1 goto doxymove

            ! ring dummy atom initial coordinate
            coor set xdir 9000.0 ydir 9000.0 zdir 9000.0 sele segid dum end
         endif

         calc xtran = @xhead + @xmove
         calc ytran = @yhead + @ymove

         calc rotang = 0.0
         label dorot

            coor rotate zdir 1.0 xcen @xtran ycen @ytran zcen @zhead phi @rotang sele target end

            set dotrans = 1
            label doclash
               if dotrans .eq. 2 coor trans xdir  1.0 ydir  1.0 dist 0.71 sele target end
               if dotrans .eq. 3 coor trans xdir  1.0 ydir -1.0 dist 0.71 sele target end
               if dotrans .eq. 4 coor trans xdir -1.0 ydir  1.0 dist 0.71 sele target end
               if dotrans .eq. 5 coor trans xdir -1.0 ydir -1.0 dist 0.71 sele target end

               if issterol .eq. yes then
                  coor dist cut 1.0 sele segid L@LipidNum .and. ( type c% .or. type c1* ) end  -
                                         sele .not. ( segid L@LipidNum .or. type POLO .or. resname TIP3 ) .and. JUNK end
                  if ?npair gt 0 goto domorerot
               else
                  if nsterol .gt. 0 then
                     ! to prevent the penetration of lipid molecules into cholesterol rings
                     coor dist cut 1.0 sele segid L@LipidNum .and. .not. resname TIP3 .and. .not. hydrogen end  -
                                            sele STEROL .and. ( type c% .or. type c1* ) .and. JUNK end
                     if ?npair gt 10 goto domorerot
                  endif

                  !protein-check
                  !
                  coor dist cut 1.7 sele segid L@LipidNum .and. .not. resname TIP3 .and. .not. hydrogen end  -
                                        sele PROT .and. .not. resname TIP3 .and. JUNK end
                  if ?npair gt 8 goto domorerot

                  !lipid-check
                  !
                  coor dist cut 1.2 sele segid L@LipidNum .and. .not. resname TIP3 .and. .not. hydrogen end  -
                                         sele .not. ( segid L@LipidNum .or. type POLO .or. resname TIP3 .or. PROT ) .and. JUNK end
                  if ?npair gt @nbad goto domorerot
               endif

               if dotrans .eq. 2 coor trans xdir -1.0 ydir -1.0 dist 0.71 sele target end
               if dotrans .eq. 3 coor trans xdir -1.0 ydir  1.0 dist 0.71 sele target end
               if dotrans .eq. 4 coor trans xdir  1.0 ydir -1.0 dist 0.71 sele target end
               if dotrans .eq. 5 coor trans xdir  1.0 ydir  1.0 dist 0.71 sele target end

            incr dotrans by 1
            if dotrans .le. 5 goto doclash

            if nimyn .gt. 0 coor trans ydir @A sele imyn end
            if nimxn .gt. 0 coor trans xdir @A sele imxn end
            if nimyp .gt. 0 coor trans ydir -@A sele imyp end
            if nimxp .gt. 0 coor trans xdir -@A sele imxp end

            if npryn .gt. 0 coor trans ydir -@A sele pryn end
            if nprxn .gt. 0 coor trans xdir -@A sele prxn end
            if npryp .gt. 0 coor trans ydir @A sele pryp end
            if nprxp .gt. 0 coor trans xdir @A sele prxp end

            goto nextlipid

         label domorerot
         increase rotang by @delang
         if rotang .le. 359 goto dorot

         coor trans xdir -@xmove ydir -@ymove sele target end
      increase nxymove by 1
      if nxymove .le. 9 goto doxymove

      if nimyn .gt. 0 coor trans ydir @A sele imyn end
      if nimxn .gt. 0 coor trans xdir @A sele imxn end
      if nimyp .gt. 0 coor trans ydir -@A sele imyp end
      if nimxp .gt. 0 coor trans xdir -@A sele imxp end

      if npryn .gt. 0 coor trans ydir -@A sele pryn end
      if nprxn .gt. 0 coor trans xdir -@A sele prxn end
      if npryp .gt. 0 coor trans ydir @A sele pryp end
      if nprxp .gt. 0 coor trans xdir @A sele prxp end

      delete atoms sele segid L@LipidNum end
      goto repeatrand

      label nextlipid

   ! continue for total number of lipids that are needed
   incr LipidNum by 1

if LipidNum le @NLipid goto loop_gen

!==============================================================================
! delete the vdW spheres
delete atom sele type POLO .or. segid DUM  end
delete atom sele PROT end

!==============================================================================
! separate Lipid and Water
!

define water sele resn TIP3 .and. type OH2 end
set nwater = ?nsel

open write unit 10 card name step4_lipid.psf
write psf  unit 10 card

open write unit 10 card name step4_lipid.crd
write coor unit 10 card
close unit 10

if nwater .ne. 0 then
   delete atom sele .not. resname TIP3 end

   set cnt = 1
   label jointip3
      define TIP3 sele segid L* .and. resname TIP3 end
      if ?nsel .eq. 0 goto exitjointip3

      if cnt eq 1 then
         rename segid TIP3 sele segid ?SELSEGI end
         join TIP3 renumber
      endif
      if cnt gt 1 join TIP3 ?SELSEGI renumber

      increase cnt by 1
   goto jointip3
   label exitjointip3

   open write unit 10 card name step4_lipid_water.crd
   write coor unit 10 card
   close unit 10
endif

delete atom sele all end

open read unit 10 card name step4_lipid.psf
read psf  unit 10 card

open read unit 10 card name step4_lipid.crd
read coor unit 10 card

define NONMEMB sele resn TIP3 end

if ?nsel .gt. 0 delete atom sele NONMEMB end

set cnt = 1
label joinmemb
   define MEMB sele segid L* end
   if ?nsel .eq. 0 goto exitjoinmemb

   if cnt eq 1 rename segid MEMB sele segid ?SELSEGI end
   if cnt gt 1 join MEMB ?SELSEGI renumber

   increase cnt by 1
goto joinmemb
label exitjoinmemb

if hasring .eq. yes BOMLEV -1
autogen angle dihedral
if hasring .eq. yes BOMLEV 0

open write unit 10 card name step4_lipid_lipid.psf
write psf  unit 10 card

open write unit 10 card name step4_lipid_lipid.crd
write coor unit 10 card

! check if there is lipids with three membered ring
define tris sele chem CG3C31 end
set ntri = ?nsel
if ntri .ne. 0 bomlev -1  ! some bacterial lipids have three membered ring

delete atom sele all end

!==============================================================================
! Read all individuals back
!

! Read PSF and Coordinates
open read unit 10 card name step1_pdbreader.psf
read psf  unit 10 card

open read unit 10 card name step2_orient.crd
read coor unit 10 card

! Read Lipids
open read unit 10 card name step4_lipid_lipid.psf
read psf  unit 10 card append

open read unit 10 card name step4_lipid_lipid.crd
read coor unit 10 card append

! Read Water
if nwater .gt. 0 then
   open read card unit 10 name step4_lipid_water.crd
   read sequence coor card unit 10
   generate TIP3 setup warn noangle nodihedral

   open read unit 10 card name step4_lipid_water.crd
   read coor unit 10 card resid
endif

!==============================================================================
! Write the coordinates
!

open write unit 10 card name step4_lipid.psf
write psf  unit 10 card

open write unit 10 card name step4_lipid.pdb
write coor unit 10 pdb
close unit 10

open write unit 10 card name step4_lipid.crd
write coor unit 10 card
close unit 10

open write card  unit 51 name step4_components.str
write title unit 51
* set nwater = @nwater
*

if ntri .ne. 0 then
   write title unit 51
   * bomlev -1 ! due to three membered ring
   *
endif


stop
